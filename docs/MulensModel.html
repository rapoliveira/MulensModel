
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MulensModel package &#8212; MulensModel 3.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="mulensmodel-package">
<h1>MulensModel package<a class="headerlink" href="#mulensmodel-package" title="Permalink to this headline">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.mulensobjects.html">MulensModel.mulensobjects package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MulensModel.mulensobjects.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="MulensModel.mulensobjects.lens.html">MulensModel.mulensobjects.lens module</a></li>
<li class="toctree-l3"><a class="reference internal" href="MulensModel.mulensobjects.mulenssystem.html">MulensModel.mulensobjects.mulenssystem module</a></li>
<li class="toctree-l3"><a class="reference internal" href="MulensModel.mulensobjects.source.html">MulensModel.mulensobjects.source module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MulensModel.mulensobjects.html#module-MulensModel.mulensobjects">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.orbits.html">MulensModel.orbits package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MulensModel.orbits.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="MulensModel.orbits.orbit.html">MulensModel.orbits.orbit module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MulensModel.orbits.html#module-MulensModel.orbits">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.b0b1utils.html">MulensModel.b0b1utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.binarylens.html">MulensModel.binarylens module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.binarylensimports.html">MulensModel.binarylensimports module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.binarylenswithshear.html">MulensModel.binarylenswithshear module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.causticsbinary.html">MulensModel.causticsbinary module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.causticsbinarywithshear.html">MulensModel.causticsbinarywithshear module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.causticspointwithshear.html">MulensModel.causticspointwithshear module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.coordinates.html">MulensModel.coordinates module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.elliputils.html">MulensModel.elliputils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.event.html">MulensModel.event module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.fitdata.html">MulensModel.fitdata module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.horizons.html">MulensModel.horizons module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.limbdarkeningcoeffs.html">MulensModel.limbdarkeningcoeffs module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.magnificationcurve.html">MulensModel.magnificationcurve module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.model.html">MulensModel.model module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.modelparameters.html">MulensModel.modelparameters module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.mulensdata.html">MulensModel.mulensdata module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.pointlens.html">MulensModel.pointlens module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.pointlenswithshear.html">MulensModel.pointlenswithshear module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.satelliteskycoord.html">MulensModel.satelliteskycoord module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.trajectory.html">MulensModel.trajectory module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.uniformcausticsampling.html">MulensModel.uniformcausticsampling module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.utils.html">MulensModel.utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="MulensModel.version.html">MulensModel.version module</a></li>
</ul>
</div>
</section>
<section id="module-MulensModel">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-MulensModel" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.BinaryLensPointSourceWM95Magnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">BinaryLensPointSourceWM95Magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.BinaryLensPointSourceWM95Magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._BinaryLensPointSourceMagnification</span></code></p>
<p>Equations for calculating point-source–binary-lens magnification following
the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1995ApJ...447L.105W/abstract">Witt &amp; Mao 1995, ApJL, 447, L105</a>
prescription assuming a POINT source.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.BinaryLensPointSourceVBBLMagnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">BinaryLensPointSourceVBBLMagnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.BinaryLensPointSourceVBBLMagnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._BinaryLensPointSourceMagnification</span></code></p>
<p>Equations for calculating point-source–binary-lens magnification using
VBBL for point sources.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.BinaryLensQuadrupoleMagnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">BinaryLensQuadrupoleMagnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_limb_darkening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.BinaryLensQuadrupoleMagnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="MulensModel.binarylens.html#MulensModel.binarylens.BinaryLensPointSourceMagnification" title="MulensModel.binarylens.BinaryLensPointSourceMagnification"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens.BinaryLensPointSourceMagnification</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._LimbDarkeningForMagnification</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._FiniteSource</span></code></p>
<p>Magnification in quadrupole approximation of the binary-lens/finite-source event - based on
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008ApJ...681.1593G/abstract">Gould 2008 ApJ 681, 1593</a>.</p>
<p>The origin of the coordinate system is at the center of mass and
both masses are on X axis with higher mass at negative X; this
means that the higher mass is at (X, Y)=(-s*q/(1+q), 0) and
the lower mass is at (s/(1+q), 0).</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
<dt>gamma: <em>float</em></dt><dd><p>Linear limb-darkening coefficient in gamma convention.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.BinaryLensHexadecapoleMagnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">BinaryLensHexadecapoleMagnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_approximations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.BinaryLensHexadecapoleMagnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="MulensModel.binarylens.html#MulensModel.binarylens.BinaryLensQuadrupoleMagnification" title="MulensModel.binarylens.BinaryLensQuadrupoleMagnification"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens.BinaryLensQuadrupoleMagnification</span></code></a></p>
<p>Magnification in hexadecapole approximation of the binary-lens/finite-source event - based on
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008ApJ...681.1593G/abstract">Gould 2008 ApJ 681, 1593</a>.</p>
<p>For coordinate system convention see <a class="reference internal" href="#MulensModel.BinaryLensQuadrupoleMagnification" title="MulensModel.BinaryLensQuadrupoleMagnification"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryLensQuadrupoleMagnification</span></code></a></p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
<dt>gamma: <em>float</em></dt><dd><p>Linear limb-darkening coefficient in gamma convention.</p>
</dd>
<dt>all_approximations: <em>boolean</em>, optional</dt><dd><p>If <em>True, return hexadecapole, quadrupole, and point source
approximations. Default is *False</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.BinaryLensVBBLMagnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">BinaryLensVBBLMagnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_limb_darkening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.BinaryLensVBBLMagnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._BinaryLensPointSourceMagnification</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._LimbDarkeningForMagnification</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._FiniteSource</span></code></p>
<p>Binary lens finite source magnification calculated using VBBL
library that implements advanced contour integration algorithm
presented by <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2010MNRAS.408.2188B/abstract">Bozza 2010 MNRAS, 408, 2188</a>.
See also <a class="reference external" href="http://www.fisica.unisa.it/GravitationAstrophysics/VBBinaryLensing.htm">VBBL website by Valerio Bozza</a>.</p>
<p>For coordinate system convention see
<a class="reference internal" href="#MulensModel.BinaryLensQuadrupoleMagnification" title="MulensModel.BinaryLensQuadrupoleMagnification"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryLensQuadrupoleMagnification</span></code></a></p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
<dt>gamma: <em>float</em>, optional</dt><dd><p>Linear limb-darkening coefficient in gamma convention.</p>
</dd>
<dt>u_limb_darkening: <em>float</em>, optional</dt><dd><p>Linear limb-darkening coefficient in u convention.
Note that either <em>gamma</em> or <em>u_limb_darkening</em> can be
set.  If neither of them is provided then limb
darkening is ignored.</p>
</dd>
<dt>accuracy: <em>float</em>, optional</dt><dd><p>Requested accuracy of the result.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.BinaryLensAdaptiveContouringMagnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">BinaryLensAdaptiveContouringMagnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_limb_darkening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ld_accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.BinaryLensAdaptiveContouringMagnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._BinaryLensPointSourceMagnification</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._LimbDarkeningForMagnification</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens._FiniteSource</span></code></p>
<p>Binary lens finite source magnification calculated using
Adaptive Contouring method by <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2007MNRAS.377.1679D/abstract">Dominik 2007 MNRAS, 377, 1679</a></p>
<p>See also
<a class="reference external" href="http://star-www.st-and.ac.uk/~md35/Software.html">AdaptiveContouring website by Martin Dominik</a></p>
<p>For coordinate system convention see
<code class="xref py py-func docutils literal notranslate"><span class="pre">point_source_magnification()</span></code></p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
<dt>gamma: <em>float</em>, optional</dt><dd><p>Linear limb-darkening coefficient in gamma convention.</p>
</dd>
<dt>u_limb_darkening: <em>float</em></dt><dd><p>Linear limb-darkening coefficient in u convention.
Note that either <em>gamma</em> or <em>u_limb_darkening</em> can be
set.  If neither of them is provided then limb
darkening is ignored.</p>
</dd>
<dt>accuracy: <em>float</em>, optional</dt><dd><p>Requested accuracy of the result defined as the sum of
the area of the squares that determine the contour
line and the estimated total enclosed area (see sec. 4
of the paper).  As M. Dominik states: <em>“this vastly
overestimates the fractional error, and a suitable
value should be chosen by testing how its variation
affects the final results - I recommend starting at
acc = 0.1.”</em> It significantly affects execution time.</p>
</dd>
<dt>ld_accuracy: <em>float</em>, optional</dt><dd><p>Requested limb-darkening accuracy. As M. Dominik
states: <em>” Fractional uncertainty for the adaptive
Simpson integration of the limb-darkening
profile-related function during application of Green’s
theorem.”</em> It does not add execution time so can be
set to very small value.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.BinaryLensPointSourceWithShearWM95Magnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">BinaryLensPointSourceWithShearWM95Magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">convergence_K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear_G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.BinaryLensPointSourceWithShearWM95Magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="MulensModel.binarylens.html#MulensModel.binarylens.BinaryLensPointSourceWM95Magnification" title="MulensModel.binarylens.BinaryLensPointSourceWM95Magnification"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylens.BinaryLensPointSourceWM95Magnification</span></code></a></p>
<p>The binary lens with shear and convergence:
solutions, images, parities, magnifications, etc.</p>
<p>Uses Witt &amp; Mao 1995 for the binary lens magnification calculation. See
<cite>py:class:binarylens.BinaryLensPointSourceWM95Magnification</cite></p>
<p>The binary lens with shear and convergence equation is
the 9th order complex polynomial.</p>
<dl class="simple">
<dt>Attributes :</dt><dd><dl class="simple">
<dt>mass_1: <em>float</em></dt><dd><p>mass of the primary (left-hand object) as a fraction of
the total mass.</p>
</dd>
<dt>mass_2: <em>float</em></dt><dd><p>mass of the secondary (right-hand object) as a fraction of the
total mass.</p>
</dd>
<dt>separation: <em>float</em></dt><dd><p>separation between the two bodies as a fraction of the Einstein
ring.</p>
</dd>
<dt>convergence_K: <em>float</em></dt><dd><p>External mass sheet convergence.</p>
</dd>
<dt>shear_G: <em>complex</em></dt><dd><p>External mass sheat shear.</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: mass_1 and mass_2 may be defined as a fraction of some other
mass than the total mass. This is possible but not recommended -
make sure you know what you’re doing before you start using this
possibility.</p>
<p>If you’re using this class, then please cite
Peirson et al. (2022; ApJ 927, 24).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.BinaryLensPointSourceWithShearVBBLMagnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">BinaryLensPointSourceWithShearVBBLMagnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.BinaryLensPointSourceWithShearVBBLMagnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="MulensModel.binarylenswithshear.html#MulensModel.binarylenswithshear.BinaryLensPointSourceWithShearWM95Magnification" title="MulensModel.binarylenswithshear.BinaryLensPointSourceWithShearWM95Magnification"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.binarylenswithshear.BinaryLensPointSourceWithShearWM95Magnification</span></code></a></p>
<p>The binary lens with shear and convergence:
solutions, images, parities, magnifications, etc.</p>
<p>Uses VBBL.</p>
<p>The binary lens with shear and convergence equation is
the 9th order complex polynomial.</p>
<dl class="simple">
<dt>Attributes :</dt><dd><dl class="simple">
<dt>mass_1: <em>float</em></dt><dd><p>mass of the primary (left-hand object) as a fraction of
the total mass.</p>
</dd>
<dt>mass_2: <em>float</em></dt><dd><p>mass of the secondary (right-hand object) as a fraction of the
total mass.</p>
</dd>
<dt>separation: <em>float</em></dt><dd><p>separation between the two bodies as a fraction of the Einstein
ring.</p>
</dd>
<dt>convergence_K: <em>float</em></dt><dd><p>External mass sheet convergence.</p>
</dd>
<dt>shear_G: <em>complex</em></dt><dd><p>External mass sheat shear.</p>
</dd>
</dl>
</dd>
</dl>
<p>Note: mass_1 and mass_2 may be defined as a fraction of some other
mass than the total mass. This is possible but not recommended -
make sure you know what you’re doing before you start using this
possibility.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.CausticsBinary">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">CausticsBinary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.CausticsBinary" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for the caustic structure corresponding to a given (<em>q</em>, <em>s</em>),
i.e. mass ratio and separation. Implemented for 2-body lenses only.</p>
<dl class="simple">
<dt>Attributes :</dt><dd><dl class="simple">
<dt>q: <em>float</em></dt><dd><p>mass ratio between the 2 bodies; always &lt;= 1</p>
</dd>
<dt>s: <em>float</em></dt><dd><p>separation between the 2 bodies (as a fraction of the
Einstein ring)</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.CausticsBinary.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.CausticsBinary.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the caustics using <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.scatter()</span></code>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>n_points: <em>int</em>, optional</dt><dd><p>The number of points to calculate along the caustic.
Defaults to 5000.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>keywords accepted by <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.scatter()</span></code></p>
</dd>
</dl>
</dd>
</dl>
<p>Note that default scaling of axis may not be equal on both axis.
To mitigate this, use:
<code class="docutils literal notranslate"><span class="pre">plt.gca().set_aspect('equal')</span></code> or <code class="docutils literal notranslate"><span class="pre">plt.axis('equal')</span></code>
(the other possible options are <code class="docutils literal notranslate"><span class="pre">'scaled'</span></code> or <code class="docutils literal notranslate"><span class="pre">'square'</span></code>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.CausticsBinary.get_caustics">
<span class="sig-name descname"><span class="pre">get_caustics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.CausticsBinary.get_caustics" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns x and y vectors corresponding to the outlines of the
caustics.  Origin is center of mass and larger mass is on the
left (for <em>q</em> &lt; 1).</p>
<dl>
<dt>Parameters:</dt><dd><dl>
<dt>n_points<span class="classifier"><em>int</em>, optional</span></dt><dd><p>The number of points to calculate along the caustic.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl>
<dt>x, y<span class="classifier"><em>list</em></span></dt><dd><p>Two lists of length <em>n_points</em> giving the <em>x</em>, <em>y</em>
coordinates of the caustic points.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.CausticsBinary.critical_curve">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">critical_curve</span></span><a class="headerlink" href="#MulensModel.CausticsBinary.critical_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Critical curve stored as <a class="reference internal" href="#MulensModel.CausticsBinary.CriticalCurve" title="MulensModel.CausticsBinary.CriticalCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">CriticalCurve</span></code></a> object, read-only</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.CausticsBinary.CriticalCurve">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">CriticalCurve</span></span><a class="headerlink" href="#MulensModel.CausticsBinary.CriticalCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Internal class of <code class="xref py py-class docutils literal notranslate"><span class="pre">Caustics</span></code>. Defines the critical
curve (in the lens plane). Origin is center of mass with
larger mass on the left (<em>q</em> &lt; 1).</p>
<dl>
<dt>Attributes :</dt><dd><dl>
<dt>x, y<span class="classifier"><em>list</em></span></dt><dd><p>Two lists of length <em>n_points</em> giving the x, y
coordinates of the caustic points.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.CausticsPointWithShear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">CausticsPointWithShear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">convergence_K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear_G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.CausticsPointWithShear" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="MulensModel.causticsbinary.html#MulensModel.causticsbinary.CausticsBinary" title="MulensModel.causticsbinary.CausticsBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.causticsbinary.CausticsBinary</span></code></a></p>
<p>Class for the caustic structure produced by the Chang-Refsdal lens,
i.e. single mass with shear and convergence.</p>
<dl class="simple">
<dt>Attributes :</dt><dd><dl class="simple">
<dt>convergence_K: <em>float</em></dt><dd><p>convergence of the lens system</p>
</dd>
<dt>shear_G: <em>complex</em></dt><dd><p>shear of the the lens system</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.CausticsBinaryWithShear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">CausticsBinaryWithShear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shear_G</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.CausticsBinaryWithShear" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="MulensModel.causticsbinary.html#MulensModel.causticsbinary.CausticsBinary" title="MulensModel.causticsbinary.CausticsBinary"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.causticsbinary.CausticsBinary</span></code></a></p>
<p>Caustics structure for a binary lens with shear and convergence.</p>
<dl class="simple">
<dt>Attributes :</dt><dd><dl class="simple">
<dt>q: <em>float</em></dt><dd><p>mass ratio between the 2 bodies; always &lt;= 1</p>
</dd>
<dt>s: <em>float</em></dt><dd><p>separation between the 2 bodies (as a fraction of the
Einstein ring)</p>
</dd>
<dt>convergence_K: <em>float</em></dt><dd><p>convergence of the lens system</p>
</dd>
<dt>shear_G: <em>complex</em></dt><dd><p>shear of the the lens system</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.Coordinates">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">Coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.coordinates.sky_coordinate.SkyCoord</span></code></p>
<p>A class for the coordinates (RA, Dec) of an event. Inherits from
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html">astropy.SkyCoord</a>.</p>
<p>May be set as a <em>str</em>, pair of <em>str</em>, or <em>SkyCoord</em> object, e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="n">Coordinates</span><span class="p">(</span><span class="s1">&#39;18:00:00 -30:00:00&#39;</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">(</span><span class="s1">&#39;18h00m00s&#39;</span><span class="p">,</span> <span class="s1">&#39;-30d00m00s&#39;</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="s1">&#39;18:00:00 -30:00:00&#39;</span><span class="p">,</span>
            <span class="n">unit</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">hourangle</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)))</span>
<span class="n">Coordinates</span><span class="p">(</span><span class="n">SkyCoord</span><span class="p">(</span><span class="mf">270.000</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.000</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">))</span>
</pre></div>
</div>
<p>If the unit keyword is not specified, defaults to
unit=(u.hourangle, u.deg) where u is defined by “import
astropy.units as u”.</p>
<p>You can print an instance of this class.</p>
<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Coordinates.galactic_l">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">galactic_l</span></span><a class="headerlink" href="#MulensModel.Coordinates.galactic_l" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.coordinates.angles.Longitude</em></p>
<p>Galactic longitude. Note that for connivance, the values l &gt;
180 degrees are represented as 360-l.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Coordinates.galactic_b">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">galactic_b</span></span><a class="headerlink" href="#MulensModel.Coordinates.galactic_b" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.coordinates.angles.Latitude</em></p>
<p>Galactic latitude calculated from (RA, Dec)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Coordinates.ecliptic_lon">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ecliptic_lon</span></span><a class="headerlink" href="#MulensModel.Coordinates.ecliptic_lon" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.coordinates.angles.Longitude</em></p>
<p>ecliptic longitude calculated from (RA, Dec)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Coordinates.ecliptic_lat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ecliptic_lat</span></span><a class="headerlink" href="#MulensModel.Coordinates.ecliptic_lat" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.coordinates.angles.Latitude</em></p>
<p>ecliptic latitude calculated from (RA, Dec)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Coordinates.north_projected">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">north_projected</span></span><a class="headerlink" href="#MulensModel.Coordinates.north_projected" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.array</em></p>
<p>North projected on the plane of the sky.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Coordinates.east_projected">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">east_projected</span></span><a class="headerlink" href="#MulensModel.Coordinates.east_projected" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.array</em></p>
<p>East projected on the plane of the sky.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Coordinates.v_Earth_projected">
<span class="sig-name descname"><span class="pre">v_Earth_projected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_BJD</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Coordinates.v_Earth_projected" title="Permalink to this definition">¶</a></dt>
<dd><p>Earth velocity at <em>full_BJD</em> projected on the plane of sky towards
given coordinates.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>full_BJD: <em>float</em></dt><dd><p>Epoch for which projected velocity is requested. In most cases
it is
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters.t_0_par" title="MulensModel.modelparameters.ModelParameters.t_0_par"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_0_par</span></code></a></p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>v_Earth_perp_N: <em>float</em></dt><dd><p>North component of Earth’s projected velocity in km/s.</p>
</dd>
<dt>v_Earth_perp_E: <em>float</em></dt><dd><p>East component of Earth’s projected velocity in km/s.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.Event">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">Event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_blend_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_source_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_source_flux_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Combines a microlensing model with data. Allows calculating chi^2 and
making a number of plots.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>datasets:  <a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a> object or a <em>list</em> of such objects</dt><dd><p>Datasets that will be linked to the event. These datasets will
be used for chi^2 calculation, plotting etc.</p>
</dd>
<dt>model: <a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model" title="MulensModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></dt><dd><p>Microlensing model that will be linked to the event. In order to
get chi^2 for different sets of model parameters you should
keep a single <a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model" title="MulensModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> instance and
change parameters for this model (i.e., do not provide separate
<a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model" title="MulensModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> instances).</p>
</dd>
<dt>coords: <em>str</em>, <a class="reference internal" href="MulensModel.coordinates.html#MulensModel.coordinates.Coordinates" title="MulensModel.coordinates.Coordinates"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coordinates</span></code></a>, or <a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html">astropy.SkyCoord</a></dt><dd><p>Coordinates of the event. If <em>str</em>, then needs format accepted by
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.coordinates.SkyCoord.html">astropy.SkyCoord</a> e.g., <code class="docutils literal notranslate"><span class="pre">'18:00:00</span> <span class="pre">-30:00:00'</span></code>.</p>
</dd>
<dt>fix_blend_flux, fix_source_flux: <em>dict</em></dt><dd><p>Used to fix the source flux(es) or blend flux
for a particular dataset. The dataset is
the key, and the value to be fixed is the value. For example, to
fix the blending of some dataset <em>my_data</em> to zero set
<em>fix_blend_flux={my_data: 0.}</em>. See also
<a class="reference internal" href="MulensModel.fitdata.html#MulensModel.fitdata.FitData" title="MulensModel.fitdata.FitData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FitData</span></code></a> .</p>
</dd>
<dt>fix_source_flux_ratio: <em>dict</em></dt><dd><p>Used to fix the flux ratio for a given band or dataset. The keys
should be either <a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a>
objects or <em>str</em>. If a
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a> object is specified,
it will take precedence over a band.</p>
</dd>
<dt>data_ref: <em>int</em> or <a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a></dt><dd><p>Reference dataset. If <em>int</em> then gives index of reference dataset
in <a class="reference internal" href="#MulensModel.Event.datasets" title="MulensModel.Event.datasets"><code class="xref py py-attr docutils literal notranslate"><span class="pre">datasets</span></code></a>. Default is the first dataset.</p>
</dd>
</dl>
</dd>
</dl>
<p>The datasets can be in magnitude or flux spaces. When we calculate chi^2
we do it in magnitude or flux space depending on value of
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData.chi2_fmt" title="MulensModel.mulensdata.MulensData.chi2_fmt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">chi2_fmt</span></code></a> attribute.
If dataset is in magnitude space and model results
in negative flux, then we calculate chi^2 in flux space but only for the
epochs with negative model flux.</p>
<p>You can print an instance of this class. Information on model and datasets
will be provided.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_errorbars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2450000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2460000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic plotting. Default is to plot the light curve with the residuals.
If the model has 2 or more lenses, also plot the source trajectory with
caustics. For more detailed control over the plotting, see
<a class="reference internal" href="#MulensModel.Event.plot_model" title="MulensModel.Event.plot_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_model()</span></code></a>, <a class="reference internal" href="#MulensModel.Event.plot_data" title="MulensModel.Event.plot_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_data()</span></code></a>, and
<a class="reference internal" href="#MulensModel.Event.plot_trajectory" title="MulensModel.Event.plot_trajectory"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_trajectory()</span></code></a>.</p>
<dl class="simple">
<dt>Keywords:</dt><dd><dl class="simple">
<dt>t_range: <em>list</em>, <em>tuple</em></dt><dd><p>Time range over which to show the light curve plot.</p>
</dd>
<dt>residuals: <em>bool</em></dt><dd><p>Whether or not to plot the residuals with the light curve.</p>
</dd>
<dt>show_errorbars: <em>bool</em></dt><dd><p>Whether or not to show the errorbars on the data. Default is
<em>None</em> (see <a class="reference internal" href="#MulensModel.Event.plot_data" title="MulensModel.Event.plot_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_data()</span></code></a>).</p>
</dd>
<dt>show_bad: <em>bool</em></dt><dd><p>Whether or not to show data points marked as “bad” (see
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData.bad" title="MulensModel.mulensdata.MulensData.bad"><code class="xref py py-attr docutils literal notranslate"><span class="pre">bad</span></code></a>). Default is
<em>None</em> (see <a class="reference internal" href="#MulensModel.Event.plot_data" title="MulensModel.Event.plot_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_data()</span></code></a>).</p>
</dd>
<dt>legend: <em>bool</em></dt><dd><p>Whether or not to show a legend for the datasets.</p>
</dd>
<dt>trajectory: <em>bool</em></dt><dd><p>Whether or not to plot the source trajectory. Defaults to
<em>False</em> for single lens events and <em>True</em> for binary lenses.</p>
</dd>
<dt>title: <em>str</em></dt><dd><p>Title for the plot. Same title is used for trajectory plot, if
applicable.</p>
</dd>
<dt>subtract_2450000, subtract_2460000: <em>bool</em></dt><dd><p>see <a class="reference internal" href="#MulensModel.Event.plot_data" title="MulensModel.Event.plot_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_data()</span></code></a>.</p>
</dd>
<dt>data_ref:  <em>int</em> or <em>MulensData</em></dt><dd><p>see <a class="reference internal" href="#MulensModel.Event.plot_data" title="MulensModel.Event.plot_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_data()</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.plot_model">
<span class="sig-name descname"><span class="pre">plot_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.plot_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the model light curve in magnitudes. See
<a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model.plot_lc" title="MulensModel.model.Model.plot_lc"><code class="xref py py-func docutils literal notranslate"><span class="pre">MulensModel.model.Model.plot_lc()</span></code></a> for details.</p>
<dl class="simple">
<dt>Keywords :</dt><dd><dl class="simple">
<dt>data_ref: <em>int</em> or <em>MulensData</em></dt><dd><p>If data_ref is not specified, uses <a class="reference internal" href="#MulensModel.Event.data_ref" title="MulensModel.Event.data_ref"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data_ref</span></code></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>Keywords passed to
<a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model.plot_lc" title="MulensModel.model.Model.plot_lc"><code class="xref py py-func docutils literal notranslate"><span class="pre">MulensModel.model.Model.plot_lc()</span></code></a>.
You can use them to set time range plotted, fluxes,
limb-darkening etc.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.plot_data">
<span class="sig-name descname"><span class="pre">plot_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phot_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_errorbars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2450000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2460000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.plot_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the data scaled to the model.</p>
<dl class="simple">
<dt>Keywords (all optional):</dt><dd><dl class="simple">
<dt>phot_fmt: <em>string</em> (‘mag’, ‘flux’)</dt><dd><p>Whether to plot the data in magnitudes or in flux. Default
is ‘mag’.</p>
</dd>
<dt>data_ref: <em>int</em> or <em>MulensData</em></dt><dd><p>If data_ref is not specified, uses <a class="reference internal" href="#MulensModel.Event.data_ref" title="MulensModel.Event.data_ref"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data_ref</span></code></a>.</p>
</dd>
<dt>show_errorbars: <em>boolean</em> or <em>None</em></dt><dd><p>Do you want errorbars to be shown for all datasets?
Default is <em>None</em>, which means the option is taken from each
dataset plotting properties (for which default is <em>True</em>).
If <em>True</em>, then data are plotted using matplotlib.errorbar().
If <em>False</em>, then data are plotted using matplotlib.scatter().</p>
</dd>
<dt>show_bad: <em>boolean</em> or <em>None</em></dt><dd><p>Do you want data marked as bad to be shown?
Default is <em>None</em>, which means the option is taken from each
dataset plotting properties (for which default is <em>False</em>).
If bad data are shown, then they are plotted with ‘x’ marker.</p>
</dd>
<dt>subtract_2450000, subtract_2460000: <em>boolean</em></dt><dd><p>If True, subtracts 2450000 or 2460000 from the time
axis to get more human-scale numbers. If using, make
sure to also set the same settings for all other
plotting calls (e.g. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_lc()</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>Passed to matplotlib plotting functions. Contrary to
previous behavior, <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> are no longer remembered.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.plot_residuals">
<span class="sig-name descname"><span class="pre">plot_residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_errorbars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2450000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2460000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.plot_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the residuals (in magnitudes) to the model.</p>
<dl class="simple">
<dt>Keywords:</dt><dd><p>For explanation of keywords, see doctrings in
<a class="reference internal" href="#MulensModel.Event.plot_data" title="MulensModel.Event.plot_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_data()</span></code></a>. Note different order of keywords.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.plot_trajectory">
<span class="sig-name descname"><span class="pre">plot_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.plot_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the trajectory of the source. See
<a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model.plot_trajectory" title="MulensModel.model.Model.plot_trajectory"><code class="xref py py-func docutils literal notranslate"><span class="pre">MulensModel.model.Model.plot_trajectory()</span></code></a> for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.plot_source_for_datasets">
<span class="sig-name descname"><span class="pre">plot_source_for_datasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.plot_source_for_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot source positions for all linked datasets.
See <a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model.plot_source" title="MulensModel.model.Model.plot_source"><code class="xref py py-func docutils literal notranslate"><span class="pre">MulensModel.model.Model.plot_source()</span></code></a> for
details.</p>
<p>Note: plots all points in datasets (including ones flagged as bad)
using the same marker.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.get_flux_for_dataset">
<span class="sig-name descname"><span class="pre">get_flux_for_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.get_flux_for_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the source and blend flux for a given dataset.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><p>dataset: <a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a> or <em>int</em>
If <em>int</em> should be the index (starting at 0) of the appropriate
dataset in the <a class="reference internal" href="#MulensModel.Event.datasets" title="MulensModel.Event.datasets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">datasets</span></code></a> list.</p>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>source_flux: <em>np.ndarray</em></dt><dd><p>flux of sources. see
<a class="reference internal" href="MulensModel.fitdata.html#MulensModel.fitdata.FitData.source_fluxes" title="MulensModel.fitdata.FitData.source_fluxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">source_fluxes</span></code></a></p>
</dd>
<dt>blend_flux: <em>float</em></dt><dd><p>blending flux. see
<a class="reference internal" href="MulensModel.fitdata.html#MulensModel.fitdata.FitData.blend_flux" title="MulensModel.fitdata.FitData.blend_flux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">blend_flux</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
<p>NOTE: This function does not recalculate fits or fluxes. If the data
haven’t yet been fit to the model (i.e. self.fits = None),
it will run <a class="reference internal" href="#MulensModel.Event.fit_fluxes" title="MulensModel.Event.fit_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_fluxes()</span></code></a>. Otherwise, it just accesses the
existing values. So if you change something in <a class="reference internal" href="MulensModel.model.html#module-MulensModel.model" title="MulensModel.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a> or
some fit parameter (e.g., <code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_blend_flux</span></code>), be sure to run
<a class="reference internal" href="#MulensModel.Event.fit_fluxes" title="MulensModel.Event.fit_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_fluxes()</span></code></a> first.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.get_ref_fluxes">
<span class="sig-name descname"><span class="pre">get_ref_fluxes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.get_ref_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get source and blending fluxes for the reference dataset. See
<a class="reference internal" href="#MulensModel.Event.get_flux_for_dataset" title="MulensModel.Event.get_flux_for_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_flux_for_dataset()</span></code></a>. If the reference dataset is not
set, uses the first dataset as default. See <a class="reference internal" href="#MulensModel.Event.data_ref" title="MulensModel.Event.data_ref"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data_ref</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.get_chi2">
<span class="sig-name descname"><span class="pre">get_chi2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.get_chi2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates chi^2 of current model by fitting for source and
blending fluxes.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>chi2: <em>float</em></dt><dd><p>Chi^2 value</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.get_chi2_for_dataset">
<span class="sig-name descname"><span class="pre">get_chi2_for_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.get_chi2_for_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates chi^2 for a single dataset</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>index_dataset: <em>int</em></dt><dd><p>index that specifies for which dataset the chi^2 is requested</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>chi2: <em>float</em></dt><dd><p>chi2 for dataset[index_dataset].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.get_chi2_per_point">
<span class="sig-name descname"><span class="pre">get_chi2_per_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.get_chi2_per_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates chi^2 for each data point of the current model by
fitting for source and blending fluxes.</p>
<dl>
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bad: <em>bool</em></dt><dd><p>Should chi2 be also caclulated for points marked as bad in
MulensData? If <cite>False</cite> (default), then bad epochs have chi2 of
<cite>np.nan</cite>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>chi2: <em>list</em> of <em>np.ndarray</em></dt><dd><p>Chi^2 contribution from each data point,
e.g. <code class="docutils literal notranslate"><span class="pre">chi2[data_num][k]</span></code> returns the chi2 contribution
from the <em>k</em>-th point of dataset <em>data_num</em>.</p>
</dd>
</dl>
</dd>
<dt>Example :</dt><dd><p>Assuming <code class="docutils literal notranslate"><span class="pre">event</span></code> is instance of Event class to get chi2
for 10-th point point of 0-th dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chi2</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get_chi2_per_point</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chi2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.get_chi2_gradient">
<span class="sig-name descname"><span class="pre">get_chi2_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.get_chi2_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit for fluxes and calculate chi^2 gradient (also called Jacobian),
i.e., <span class="math notranslate nohighlight">\(d chi^2/d parameter\)</span>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>parameters: <em>str</em> or <em>list</em>, required</dt><dd><p>Parameters with respect to which gradient is calculated.
Currently accepted parameters are: <code class="docutils literal notranslate"><span class="pre">t_0</span></code>, <code class="docutils literal notranslate"><span class="pre">u_0</span></code>, <code class="docutils literal notranslate"><span class="pre">t_eff</span></code>,
<code class="docutils literal notranslate"><span class="pre">t_E</span></code>, <code class="docutils literal notranslate"><span class="pre">pi_E_N</span></code>, and <code class="docutils literal notranslate"><span class="pre">pi_E_E</span></code>. The parameters for
which you request gradient must be defined in py:attr:<cite>~model</cite>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>gradient: <em>float</em> or <em>np.ndarray</em></dt><dd><p>chi^2 gradient</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.calculate_chi2_gradient">
<span class="sig-name descname"><span class="pre">calculate_chi2_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.calculate_chi2_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate chi^2 gradient (also called Jacobian), i.e.,
<span class="math notranslate nohighlight">\(d chi^2/d parameter\)</span>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>parameters: <em>str</em> or <em>list</em>, required</dt><dd><p>Parameters with respect to which gradient is calculated.
Currently accepted parameters are: <code class="docutils literal notranslate"><span class="pre">t_0</span></code>, <code class="docutils literal notranslate"><span class="pre">u_0</span></code>, <code class="docutils literal notranslate"><span class="pre">t_eff</span></code>,
<code class="docutils literal notranslate"><span class="pre">t_E</span></code>, <code class="docutils literal notranslate"><span class="pre">pi_E_N</span></code>, and <code class="docutils literal notranslate"><span class="pre">pi_E_E</span></code>. The parameters for
which you request gradient must be defined in py:attr:<cite>~model</cite>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>gradient: <em>float</em> or <em>np.ndarray</em></dt><dd><p>chi^2 gradient</p>
</dd>
</dl>
</dd>
</dl>
<p>NOTE: Because this is not a ‘get’ function, it ASSUMES you have ALREADY
fit for the fluxes, e.g. by calling get_chi2().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Event.fit_fluxes">
<span class="sig-name descname"><span class="pre">fit_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Event.fit_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit for the optimal fluxes for each dataset (and its chi2)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.coords">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coords</span></span><a class="headerlink" href="#MulensModel.Event.coords" title="Permalink to this definition">¶</a></dt>
<dd><p>see <a class="reference internal" href="MulensModel.coordinates.html#MulensModel.coordinates.Coordinates" title="MulensModel.coordinates.Coordinates"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coordinates</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#MulensModel.Event.model" title="Permalink to this definition">¶</a></dt>
<dd><p>an instance of <a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model" title="MulensModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.datasets">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">datasets</span></span><a class="headerlink" href="#MulensModel.Event.datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>a <em>list</em> of <a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a>
instances.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.data_ref">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_ref</span></span><a class="headerlink" href="#MulensModel.Event.data_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference data set for scaling the model fluxes to (for
plotting). May be set as a
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a> object or an
index (<em>int</em>). Default is the first data set.</p>
<dl class="simple">
<dt>Returns :</dt><dd><p>index (<em>int</em>) of the relevant dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.chi2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chi2</span></span><a class="headerlink" href="#MulensModel.Event.chi2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Chi^2 value. Note this is a static property. It is only updated when
<a class="reference internal" href="#MulensModel.Event.fit_fluxes" title="MulensModel.Event.fit_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_fluxes()</span></code></a> or <a class="reference internal" href="#MulensModel.Event.get_chi2" title="MulensModel.Event.get_chi2"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_chi2()</span></code></a> is run. So, if you
change one of the settings be sure to run one of those functions to
update the chi2.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.chi2_gradient">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chi2_gradient</span></span><a class="headerlink" href="#MulensModel.Event.chi2_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Return previously calculated chi^2 gradient (also called Jacobian),
i.e., <span class="math notranslate nohighlight">\(d chi^2/d parameter\)</span>. See <a class="reference internal" href="#MulensModel.Event.get_chi2_gradient" title="MulensModel.Event.get_chi2_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_chi2_gradient()</span></code></a>
and <a class="reference internal" href="#MulensModel.Event.calculate_chi2_gradient" title="MulensModel.Event.calculate_chi2_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_chi2_gradient()</span></code></a>.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>gradient: <em>float</em> or <em>np.ndarray</em></dt><dd><p>chi^2 gradient. Will return None if the chi2 gradient was not
previously calculated using one of the functions mentioned
above.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.fits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fits</span></span><a class="headerlink" href="#MulensModel.Event.fits" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> of <a class="reference internal" href="MulensModel.fitdata.html#MulensModel.fitdata.FitData" title="MulensModel.fitdata.FitData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FitData</span></code></a> objects</p>
<p>There is one <a class="reference internal" href="MulensModel.fitdata.html#MulensModel.fitdata.FitData" title="MulensModel.fitdata.FitData"><code class="xref py py-class docutils literal notranslate"><span class="pre">FitData</span></code></a> object for
each dataset containing the information for fitting the model to
that dataset, e.g. fitted fluxes, chi2 (for that dataset).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.fluxes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fluxes</span></span><a class="headerlink" href="#MulensModel.Event.fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em></p>
<p>An array giving the fitted source and blend flux(es) for each dataset.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.source_fluxes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_fluxes</span></span><a class="headerlink" href="#MulensModel.Event.source_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em></p>
<p>An array giving the fitted source flux(es) for each dataset.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.blend_fluxes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">blend_fluxes</span></span><a class="headerlink" href="#MulensModel.Event.blend_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em></p>
<p>An array giving the fitted blend flux for each dataset.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Event.sum_function">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sum_function</span></span><a class="headerlink" href="#MulensModel.Event.sum_function" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em></p>
<p>Function used for adding chi^2 contributions. Can be either
‘numpy.sum’ (default value) or ‘math.fsum’.
The latter is slightly slower and more accurate,
which may be important for large datasets.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.FitData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">FitData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_blend_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_source_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_source_flux_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Performs a least squares linear fit for given dataset and model to
determine the source flux(es) and (optionally) blend flux. After creating
the object, you must run <a class="reference internal" href="#MulensModel.FitData.update" title="MulensModel.FitData.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> to perform the linear fit for
the fluxes and calculate the chi2. To perform the linear fit without
calculating chi2, you can run <a class="reference internal" href="#MulensModel.FitData.fit_fluxes" title="MulensModel.FitData.fit_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_fluxes()</span></code></a>. If you change
anything in the object, e.g. the model parameters, you <em>must</em> re-run
<a class="reference internal" href="#MulensModel.FitData.update" title="MulensModel.FitData.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> or <a class="reference internal" href="#MulensModel.FitData.fit_fluxes" title="MulensModel.FitData.fit_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_fluxes()</span></code></a>.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>model: <a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model" title="MulensModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> object</dt><dd><p>The model to fit to the data.</p>
</dd>
<dt>dataset: <a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a> object</dt><dd><p>A single photometric dataset to be fitted.</p>
</dd>
<dt>fix_blend_flux: <em>False</em> or <em>float</em>, optional</dt><dd><p>Default is <em>False</em>, i.e. allow the blend flux to be a free
parameter. If set to a float, it will fix the blend value to that
value.</p>
</dd>
<dt>fix_source_flux: <em>False</em>, <em>float</em>, or <em>list</em>, optional</dt><dd><p>Default is <em>False</em>, i.e. allow the source flux to be a free
parameter. If set to a float, it will fix the source value to that
value. For binary source models, a list should be used to set the
fluxes of the individual sources or fix one and not the other, e.g.
[2.3, False] would fix source_flux_0 to 2.3 but allow a free fit to
source_flux_1.</p>
</dd>
<dt>fix_source_flux_ratio: <em>False</em> or <em>float</em>, optional</dt><dd><p>For binary source models, source_flux_ratio is the flux ratio
between two  components, i.e.,
source_flux_ratio = source_flux_1 / source_flux_0
Default is <em>False</em>, i.e. allow the source flux to be a free
parameter. If set to a float, it will fix the source value to that
value.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the best-fit source and blend fluxes as well as the chi2.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bad: <em>bool</em></dt><dd><p>Default is <em>False</em>. If <em>True</em> recalculates the data
magnification for each point to ensure that there are values
even for bad datapoints.</p>
</dd>
</dl>
</dd>
</dl>
<p>No returns.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.fit_fluxes">
<span class="sig-name descname"><span class="pre">fit_fluxes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.fit_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the linear least squares fit to determine the fitted fluxes.
Sets the values of <a class="reference internal" href="#MulensModel.FitData.source_fluxes" title="MulensModel.FitData.source_fluxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">source_fluxes</span></code></a>, <a class="reference internal" href="#MulensModel.FitData.blend_flux" title="MulensModel.FitData.blend_flux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">blend_flux</span></code></a>,
and (if applicable) <a class="reference internal" href="#MulensModel.FitData.source_flux" title="MulensModel.FitData.source_flux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">source_flux</span></code></a>.</p>
<p>Does <em>not</em> calculate chi2. To fit for the fluxes and calculate chi2,
run <a class="reference internal" href="#MulensModel.FitData.update" title="MulensModel.FitData.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a>.</p>
<p>No parameters.</p>
<p>No returns.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_data_magnification">
<span class="sig-name descname"><span class="pre">get_data_magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_data_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the model magnification for each data point.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bad: <em>boolean</em></dt><dd><p>If <em>True</em>, calculates the magnification for all points.
If <em>False</em>, only calculates the magnification for good data
points. Values for bad data points are set to 0. Default is
<em>False</em>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>data_magnification: <em>np.ndarray</em></dt><dd><p>The model magnification evaluated for each datapoint. If there
is more than one source, the magnification of each source is
reported separately.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_model_fluxes">
<span class="sig-name descname"><span class="pre">get_model_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_model_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate model in flux space.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bad: <em>bool</em></dt><dd><p>Default is <em>False</em>. If <em>True</em> recalculates the data
magnification for each point to ensure that the values
for bad datapoints are calculated (otherwise, they are set to
the magnitude of the blend).</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>model_flux: <em>np.ndarray</em></dt><dd><p>The model flux evaluated for each datapoint.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_model_magnitudes">
<span class="sig-name descname"><span class="pre">get_model_magnitudes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_model_magnitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate model in magnitude space</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>see <a class="reference internal" href="#MulensModel.FitData.get_model_fluxes" title="MulensModel.FitData.get_model_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_model_fluxes()</span></code></a></p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>model_mag: <em>np.ndarray</em></dt><dd><p>The model magnitude evaluated for each datapoint.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.scale_fluxes">
<span class="sig-name descname"><span class="pre">scale_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blend_flux</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.scale_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Rescale the data fluxes to an arbitrary flux scale:</dt><dd><p>flux = source_flux_0 * (data.flux - blend_flux) / source_flux
flux += blend_flux_0
err_flux = source_flux_0 * data.err_flux / source_flux</p>
</dd>
<dt>Parameters :</dt><dd><dl class="simple">
<dt>source_flux: <em>float</em>, <em>list</em>, <em>np.array</em></dt><dd><p>Flux of the source in the desired system. If n_sources &gt; 1 and
source_flux has more than one element, the elements are
summed to produce the overall scaling flux.</p>
</dd>
<dt>blend_flux: <em>float</em></dt><dd><p>Flux of the blend in the desired system</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>flux: <em>np.ndarray</em></dt><dd><p>Fluxes from the data rescaled to the desired system.</p>
</dd>
<dt>err_flux: <em>np.ndarray</em></dt><dd><p>Uncertainties of fluxes from the data rescaled to the desired
system.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_residuals">
<span class="sig-name descname"><span class="pre">get_residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phot_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blend_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the residuals for each datapoint relative to the model.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>phot_fmt: <em>str</em>, optional</dt><dd><p>specify whether the residuals should be returned in
magnitudes (‘mag’) or in flux (‘flux’). Default is
‘mag’. If ‘scaled’, will return the residuals in magnitudes
scaled to source_flux, blend_flux.</p>
</dd>
<dt>source_flux, blend_flux: <em>float</em></dt><dd><p>reference source and blend fluxes for scaling the residuals</p>
</dd>
<dt>bad: <em>bool</em></dt><dd><p>Default is <em>False</em>. If <em>True</em> recalculates the data
magnification for each point to ensure that there are values
even for bad datapoints.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>residuals: <em>np.ndarray</em></dt><dd><p>the residuals for the corresponding dataset.</p>
</dd>
<dt>errorbars: <em>np.ndarray</em></dt><dd><p>the scaled errorbars for each point. For plotting
errorbars for the residuals.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_chi2_gradient">
<span class="sig-name descname"><span class="pre">get_chi2_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_chi2_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits fluxes and calculates chi^2 gradient (also called Jacobian), i.e.,
<span class="math notranslate nohighlight">\(d chi^2/d parameter\)</span>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>parameters: <em>str</em> or <em>list</em>, required</dt><dd><p>Parameters with respect to which gradient is calculated.
Currently accepted parameters are: <code class="docutils literal notranslate"><span class="pre">t_0</span></code>, <code class="docutils literal notranslate"><span class="pre">u_0</span></code>, <code class="docutils literal notranslate"><span class="pre">t_eff</span></code>,
<code class="docutils literal notranslate"><span class="pre">t_E</span></code>, <code class="docutils literal notranslate"><span class="pre">pi_E_N</span></code>, and <code class="docutils literal notranslate"><span class="pre">pi_E_E</span></code>. The parameters for
which you request gradient must be defined in py:attr:<cite>~model</cite>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>gradient: <em>float</em> or <em>np.ndarray</em></dt><dd><p>chi^2 gradient</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.calculate_chi2_gradient">
<span class="sig-name descname"><span class="pre">calculate_chi2_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.calculate_chi2_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates chi^2 gradient (also called Jacobian), i.e.,
<span class="math notranslate nohighlight">\(d chi^2/d parameter\)</span> WITHOUT refitting for the fluxes. Saves
computations if, e.g., you want to retrieve both py:attr:<cite>~chi2</cite> and
py:attr:<cite>~chi2_gradient</cite>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>parameters: <em>str</em> or <em>list</em>, required</dt><dd><p>Parameters with respect to which gradient is calculated.
Currently accepted parameters are: <code class="docutils literal notranslate"><span class="pre">t_0</span></code>, <code class="docutils literal notranslate"><span class="pre">u_0</span></code>, <code class="docutils literal notranslate"><span class="pre">t_eff</span></code>,
<code class="docutils literal notranslate"><span class="pre">t_E</span></code>, <code class="docutils literal notranslate"><span class="pre">pi_E_N</span></code>, and <code class="docutils literal notranslate"><span class="pre">pi_E_E</span></code>. The parameters for
which you request gradient must be defined in py:attr:<cite>~model</cite>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>gradient: <em>float</em> or <em>np.ndarray</em></dt><dd><p>chi^2 gradient</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_d_A_d_params_for_point_lens_model">
<span class="sig-name descname"><span class="pre">get_d_A_d_params_for_point_lens_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_d_A_d_params_for_point_lens_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate d A / d parameters for a point lens model.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>parameters: <em>list</em></dt><dd><p>List of the parameters to take derivatives with respect to.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>dA_dparam: <em>dict</em></dt><dd><p>Keys are parameter names from <em>parameters</em> argument above.
Values are the partial derivatives for that parameter
evaluated at each data point.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_d_A_d_rho">
<span class="sig-name descname"><span class="pre">get_d_A_d_rho</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_d_A_d_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate d A / d rho for a point lens model.</p>
<p>No Inputs</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>dA_drho: <em>np.array</em></dt><dd><p>Values are the partial derivatives for rho
evaluated at each data point.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_dataset_trajectory">
<span class="sig-name descname"><span class="pre">get_dataset_trajectory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_dataset_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> object. If
the <a class="reference internal" href="#MulensModel.FitData.dataset" title="MulensModel.FitData.dataset"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dataset</span></code></a> has an ephemerides_file, apply it to the
Trajectory, even if it is not part of the <a class="reference internal" href="MulensModel.model.html#module-MulensModel.model" title="MulensModel.model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">model</span></code></a>.</p>
<p>No parameters.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Trajectory for given dataset.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_d_A_d_u_for_PSPL_model">
<span class="sig-name descname"><span class="pre">get_d_A_d_u_for_PSPL_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_d_A_d_u_for_PSPL_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_d_A_d_u_for_FSPL_model">
<span class="sig-name descname"><span class="pre">get_d_A_d_u_for_FSPL_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_d_A_d_u_for_FSPL_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FitData.get_d_A_d_u_for_point_lens_model">
<span class="sig-name descname"><span class="pre">get_d_A_d_u_for_point_lens_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.get_d_A_d_u_for_point_lens_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.chi2_gradient">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chi2_gradient</span></span><a class="headerlink" href="#MulensModel.FitData.chi2_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em> or <em>np.ndarray</em></p>
<p>Previously calculated chi^2 gradient (also called Jacobian),
i.e., <span class="math notranslate nohighlight">\(d chi^2/d parameter\)</span>. See <a class="reference internal" href="#MulensModel.FitData.get_chi2_gradient" title="MulensModel.FitData.get_chi2_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_chi2_gradient()</span></code></a>
and <a class="reference internal" href="#MulensModel.FitData.calculate_chi2_gradient" title="MulensModel.FitData.calculate_chi2_gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_chi2_gradient()</span></code></a>.</p>
<p>Gives <em>None</em> if the chi2 gradient was not
previously calculated using one of the functions mentioned
above.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.chi2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chi2</span></span><a class="headerlink" href="#MulensModel.FitData.chi2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em>
The total chi2 for the fitted dataset. Good points only.
See <a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData.good" title="MulensModel.mulensdata.MulensData.good"><code class="xref py py-obj docutils literal notranslate"><span class="pre">good</span></code></a>.</p>
<p>If <em>None</em>, you need to run <a class="reference internal" href="#MulensModel.FitData.update" title="MulensModel.FitData.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> to execute the
linear fit and calculate the chi2.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.chi2_per_point">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chi2_per_point</span></span><a class="headerlink" href="#MulensModel.FitData.chi2_per_point" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>The chi^2 contribution from each data point,
e.g., <code class="docutils literal notranslate"><span class="pre">chi2_per_point[k]</span></code> returns the chi2 contribution
from the <em>k</em>-th point of <a class="reference internal" href="#MulensModel.FitData.dataset" title="MulensModel.FitData.dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dataset</span></code></a>. Includes bad
datapoints.</p>
<p>If <em>None</em>, you need to run <a class="reference internal" href="#MulensModel.FitData.update" title="MulensModel.FitData.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> to execute
the linear fit and calculate the chi2.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.source_flux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_flux</span></span><a class="headerlink" href="#MulensModel.FitData.source_flux" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The fitted source flux. Only defined for models with a single
source. See also <a class="reference internal" href="#MulensModel.FitData.source_fluxes" title="MulensModel.FitData.source_fluxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">source_fluxes</span></code></a></p>
<p>If <em>None</em>, you need to run <a class="reference internal" href="#MulensModel.FitData.fit_fluxes" title="MulensModel.FitData.fit_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_fluxes()</span></code></a> or
<a class="reference internal" href="#MulensModel.FitData.update" title="MulensModel.FitData.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> to execute the linear fit.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.source_fluxes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_fluxes</span></span><a class="headerlink" href="#MulensModel.FitData.source_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.array</em></p>
<p>The fitted source flux(es).</p>
<p>If <em>None</em>, you need to run <a class="reference internal" href="#MulensModel.FitData.fit_fluxes" title="MulensModel.FitData.fit_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_fluxes()</span></code></a> or
<a class="reference internal" href="#MulensModel.FitData.update" title="MulensModel.FitData.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> to execute the linear fit.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.blend_flux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">blend_flux</span></span><a class="headerlink" href="#MulensModel.FitData.blend_flux" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The fitted blend flux or the value set by
fix_blend_flux (see <a class="reference external" href="https://docs.python.org/3/reference/lexical_analysis.html#keywords" title="(in Python v3.13)"><span>Keywords</span></a>).</p>
<p>If <em>None</em>, you need to run <a class="reference internal" href="#MulensModel.FitData.fit_fluxes" title="MulensModel.FitData.fit_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_fluxes()</span></code></a> or
<a class="reference internal" href="#MulensModel.FitData.update" title="MulensModel.FitData.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> to execute the linear fit.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.source_flux_ratio">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_flux_ratio</span></span><a class="headerlink" href="#MulensModel.FitData.source_flux_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>source_flux_ratio = source_flux_1 / source_flux_0</p>
<p>i.e., the ratio of the fitted source fluxes or the value set by
fix_source_flux_ratio (see <a class="reference external" href="https://docs.python.org/3/reference/lexical_analysis.html#keywords" title="(in Python v3.13)"><span>Keywords</span></a>).</p>
<p>If <em>None</em>, you need to run <a class="reference internal" href="#MulensModel.FitData.fit_fluxes" title="MulensModel.FitData.fit_fluxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_fluxes()</span></code></a> or
<a class="reference internal" href="#MulensModel.FitData.update" title="MulensModel.FitData.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> to execute the linear fit.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.dataset">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dataset</span></span><a class="headerlink" href="#MulensModel.FitData.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a></p>
<p>A single photometric dataset to be fitted.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#MulensModel.FitData.model" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model" title="MulensModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>The model to fit to the data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.data_magnification">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_magnification</span></span><a class="headerlink" href="#MulensModel.FitData.data_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns previously calculated magnifications. To calculate the
magnifications (e.g., if something changed in the model), use
<a class="reference internal" href="#MulensModel.FitData.get_data_magnification" title="MulensModel.FitData.get_data_magnification"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_data_magnification()</span></code></a>.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>data_magnification: <em>np.ndarray</em></dt><dd><p>The model magnification evaluated for each datapoint. If there
is more than one source, the magnification of each source is
reported separately.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.magnification_curve">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">magnification_curve</span></span><a class="headerlink" href="#MulensModel.FitData.magnification_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns previously calculated magnification curve.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.magnification_curves">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">magnification_curves</span></span><a class="headerlink" href="#MulensModel.FitData.magnification_curves" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns previously calculated magnification curves.</p>
<dl class="simple">
<dt>Returns :</dt><dd><p><em>tuple</em> of
<em>:py:class:`~MulensModel.magnification.MagnificationCurve</em> objects,
i.e., the model magnification curve evaluated for each datapoint.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FitData.gamma">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gamma</span></span><a class="headerlink" href="#MulensModel.FitData.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Limb-darkening coefficient for this fit. Set by
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData.bandpass" title="MulensModel.mulensdata.MulensData.bandpass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">bandpass</span></code></a> and
<a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model.get_limb_coeff_gamma" title="MulensModel.model.Model.get_limb_coeff_gamma"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_limb_coeff_gamma()</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.FitData.FSPL_Derivatives">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FSPL_Derivatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FitData.FSPL_Derivatives" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.Horizons">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">Horizons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Horizons" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>An Object to read and hold the standard JPL Horizons output,
i.e. satellite ephemerides.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>file_name: <em>str</em></dt><dd><p>output from JPL Horizons file name</p>
</dd>
</dl>
</dd>
</dl>
<p>For info on preparing JPL Horizons file for import, see <a class="reference external" href="https://github.com/rpoleski/MulensModel/blob/master/documents/Horizons_manual.md">instructions</a>.</p>
<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Horizons.time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#MulensModel.Horizons.time" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>return times in TDB (reference frame depends on Horizons input)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Horizons.xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz</span></span><a class="headerlink" href="#MulensModel.Horizons.xyz" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Astropy.CartesianRepresentation</em></p>
<p>return X,Y,Z positions based on RA, DEC and distance</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.LimbDarkeningCoeffs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">LimbDarkeningCoeffs</span></span><a class="headerlink" href="#MulensModel.LimbDarkeningCoeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Linear limb-darkening parameters. Both <em>gamma</em> and <em>u</em> conventions
can be used.  The <em>u</em> convention is more frequently used in
studies other than microlensing.  It has fixed flux at the center.
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002ApJ...572..521A/abstract">An et al. 2002 (ApJ 572, 521)</a>
introduced the <em>gamma</em> convention:</p>
<p>gamma = (2 * u) / (3 - u)</p>
<p>u = 3 * gamma / (2 + gamma)</p>
<p>Note that the gamma convention has fixed total flux.</p>
<p>You can print an instance of this class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.LimbDarkeningCoeffs.set_limb_coeff_gamma">
<span class="sig-name descname"><span class="pre">set_limb_coeff_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.LimbDarkeningCoeffs.set_limb_coeff_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Remembers limb darkening gamma coefficient for given band.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bandpass: <em>str</em></dt><dd><p>Name of the filter.</p>
</dd>
<dt>gamma: <em>float</em></dt><dd><p>The value of gamma coefficient.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.LimbDarkeningCoeffs.get_limb_coeff_gamma">
<span class="sig-name descname"><span class="pre">get_limb_coeff_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.LimbDarkeningCoeffs.get_limb_coeff_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives limb darkening gamma coefficient for given band.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bandpass: <em>str</em></dt><dd><p>Name of the filter.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>gamma: <em>float</em></dt><dd><p>The value of gamma coefficient.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.LimbDarkeningCoeffs.set_limb_coeff_u">
<span class="sig-name descname"><span class="pre">set_limb_coeff_u</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.LimbDarkeningCoeffs.set_limb_coeff_u" title="Permalink to this definition">¶</a></dt>
<dd><p>Remembers limb darkening <em>u</em> coefficient for given band</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bandpass: <em>str</em></dt><dd><p>Name of the filter.</p>
</dd>
<dt>u: <em>float</em></dt><dd><p>The value of <em>u</em> coefficient.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.LimbDarkeningCoeffs.get_limb_coeff_u">
<span class="sig-name descname"><span class="pre">get_limb_coeff_u</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.LimbDarkeningCoeffs.get_limb_coeff_u" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives limb darkening <em>u</em> coefficient for given band.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bandpass: <em>str</em></dt><dd><p>Name of the filter.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>u: <em>float</em></dt><dd><p>The value of <em>u</em> coefficient.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.LimbDarkeningCoeffs.get_weighted_limb_coeff_gamma">
<span class="sig-name descname"><span class="pre">get_weighted_limb_coeff_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.LimbDarkeningCoeffs.get_weighted_limb_coeff_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Get weighted limb darkening coefficient in gamma space.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>weights: <em>dict</em></dt><dd><p>A dictionary that for every band (keys; <em>str</em> type)
gives its relative weight (value; <em>float</em> type), e.g.,
<code class="docutils literal notranslate"><span class="pre">weights</span> <span class="pre">=</span> <span class="pre">{'I':</span> <span class="pre">1.5,</span> <span class="pre">'V':</span> <span class="pre">1.}</span></code> will return gamma
coefficient in the case when <em>I</em> band contributes 1.5
more than <em>V</em> band. Note that for each band used you
have to first set to coefficient.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>gamma: <em>float</em></dt><dd><p>The value of weighted gamma.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">MagnificationCurve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite_skycoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MagnificationCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>The magnification curve calculated from the model light curve.</p>
<p>The key function is <a class="reference internal" href="#MulensModel.MagnificationCurve.set_magnification_methods" title="MulensModel.MagnificationCurve.set_magnification_methods"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_magnification_methods()</span></code></a>, which
specifies the method used to calculate the finite source
magnification and when to use it..</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>times: iterable of <em>floats</em></dt><dd><p>the times at which to generate the magnification curve</p>
</dd>
<dt>parameters: <a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></dt><dd><p>specifies the microlensing parameters</p>
</dd>
<dt>parallax: <em>dict</em>, optional</dt><dd><p>dictionary specifying what parallax effects should be
used, e.g., <code class="docutils literal notranslate"><span class="pre">{'earth_orbital':</span> <span class="pre">True,</span> <span class="pre">'satellite':</span> <span class="pre">False,</span>
<span class="pre">'topocentric':</span> <span class="pre">False}</span></code></p>
</dd>
<dt>coords: <a class="reference internal" href="MulensModel.coordinates.html#MulensModel.coordinates.Coordinates" title="MulensModel.coordinates.Coordinates"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coordinates</span></code></a>, optional</dt><dd><p>sky coordinates of the event</p>
</dd>
<dt>satellite_skycoord: <em>Astropy.coordinates.SkyCoord</em>, optional</dt><dd><p>sky coordinates of the satellite specified by the
ephemerides file. See
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData.satellite_skycoord" title="MulensModel.mulensdata.MulensData.satellite_skycoord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MulensModel.mulensdata.MulensData.satellite_skycoord</span></code></a>.</p>
</dd>
<dt>gamma: <em>float</em>, optional</dt><dd><p>limb darkening coefficient in gamma convention; defaults to 0</p>
</dd>
</dl>
</dd>
<dt>Attributes :</dt><dd><dl class="simple">
<dt>trajectory: <code class="xref py py-class docutils literal notranslate"><span class="pre">trajectory</span></code></dt><dd><p>Trajectory used to calculate positions of
the source that are used to calculate magnification values.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve.set_magnification_methods">
<span class="sig-name descname"><span class="pre">set_magnification_methods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MagnificationCurve.set_magnification_methods" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets methods used for magnification calculation.</p>
<dl>
<dt>For available methods, see:</dt><dd><p><a class="reference internal" href="#MulensModel.MagnificationCurve.get_point_lens_magnification" title="MulensModel.MagnificationCurve.get_point_lens_magnification"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_point_lens_magnification()</span></code></a></p>
<p>and</p>
<p><a class="reference internal" href="#MulensModel.MagnificationCurve.get_binary_lens_magnification" title="MulensModel.MagnificationCurve.get_binary_lens_magnification"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_binary_lens_magnification()</span></code></a></p>
</dd>
<dt>Parameters :</dt><dd><dl>
<dt>methods: <em>list</em></dt><dd><p>List that specifies which methods (<em>str</em>) should be
used when (<em>float</em> values for Julian dates). Given
method will be used for times between the times
between which it is on the list, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">2455746.</span><span class="p">,</span> <span class="s1">&#39;Quadrupole&#39;</span><span class="p">,</span> <span class="mf">2455746.6</span><span class="p">,</span> <span class="s1">&#39;Hexadecapole&#39;</span><span class="p">,</span>
    <span class="mf">2455746.7</span><span class="p">,</span> <span class="s1">&#39;VBBL&#39;</span><span class="p">,</span> <span class="mf">2455747.</span><span class="p">,</span> <span class="s1">&#39;Hexadecapole&#39;</span><span class="p">,</span>
    <span class="mf">2455747.15</span><span class="p">,</span> <span class="s1">&#39;Quadrupole&#39;</span><span class="p">,</span> <span class="mf">2455748.</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt>default_method: <em>str</em></dt><dd><p>Name of the method to be used for epochs outside the ranges
specified in <em>methods</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve.set_magnification_methods_parameters">
<span class="sig-name descname"><span class="pre">set_magnification_methods_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methods_parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MagnificationCurve.set_magnification_methods_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Set additional parameters for magnification calculation methods.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>methods_parameters: <em>dict</em></dt><dd><p>Dictionary that for method names (keys) returns dictionary
in the form of <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> that are passed to given method,
e.g., <code class="docutils literal notranslate"><span class="pre">{'VBBL':</span> <span class="pre">{'accuracy':</span> <span class="pre">0.005}}</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve.get_magnification">
<span class="sig-name descname"><span class="pre">get_magnification</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MagnificationCurve.get_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate magnification.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>magnification: <em>np.ndarray</em></dt><dd><p>Vector of magnifications.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve.get_point_lens_magnification">
<span class="sig-name descname"><span class="pre">get_point_lens_magnification</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MagnificationCurve.get_point_lens_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Point Lens magnification.</p>
<dl class="simple">
<dt>Allowed magnification methods (set by <a class="reference internal" href="#MulensModel.MagnificationCurve.set_magnification_methods" title="MulensModel.MagnificationCurve.set_magnification_methods"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_magnification_methods()</span></code></a>) :</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">point_source</span></code>:</dt><dd><p>standard Paczynski equation for a point source/point lens.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finite_source_uniform_Gould94</span></code>:</dt><dd><p>Uses the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1994ApJ...421L..71G/abstract">Gould 1994 ApJ, 421L, 71</a>
prescription assuming a
<em>uniform</em> (and circular) source. This method interpolates
pre-computed tables. The relative interpolation
errors are smaller than 10^-4.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finite_source_uniform_Gould94_direct</span></code>:</dt><dd><p>Same as <code class="docutils literal notranslate"><span class="pre">finite_source_uniform_Gould94</span></code>, but calculates
the underlying functions directly
(i.e., without interpolation).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finite_source_uniform_WittMao94</span></code>:</dt><dd><p>Uses the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1994ApJ...430..505W/abstract">Witt and Mao 1994 ApJ, 430, 505</a>
method assuming a <em>uniform</em> (and circular) source. This method
interpolates pre-computed tables. The relative interpolation
errors are smaller than 10^-4.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finite_source_LD_WittMao94</span></code>:</dt><dd><p>Uses the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1994ApJ...430..505W/abstract">Witt and Mao 1994 ApJ, 430, 505</a> method and
integrates multiple annuli to obtain magnification for
a circular source <em>including limb-darkening</em>. For description
of integration of multiple annuli see, e.g.,
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018MNRAS.479.5157B/abstract">Bozza et al. 2018 MNRAS, 479, 5157</a>.
This method interpolates pre-computed tables. The relative
interpolation errors are smaller than 10^-4.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finite_source_LD_Yoo04</span></code>:</dt><dd><p>Uses the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2004ApJ...603..139Y/abstract">Yoo et al. 2004 ApJ, 603, 139</a>
prescription for
a circular source <em>including limb-darkening</em>. This method
interpolates pre-computed tables. The relative interpolation
errors are smaller than 10^-4.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finite_source_LD_Yoo04_direct</span></code>:</dt><dd><p>Same as <code class="docutils literal notranslate"><span class="pre">finite_source_LD_Yoo04</span></code>, but calculates
the underlying functions directly
(i.e., without interpolation), hence can be slow.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finite_source_uniform_Lee09</span></code>:</dt><dd><p>Uses the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2009ApJ...695..200L/abstract">Lee et al. 2009 ApJ, 695, 200</a>
method for a circular and <em>uniform</em> source. This method
works well for large sources (rho ~ 1).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">finite_source_LD_Lee09</span></code>:</dt><dd><p>Uses the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2009ApJ...695..200L/abstract">Lee et al. 2009 ApJ, 695, 200</a> method for
a circular source <em>including limb-darkening</em>. This method
works well for large sources (rho ~ 1) but can be slow
compared to other methods.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>magnification: <em>np.ndarray</em></dt><dd><p>Vector of magnifications.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve.get_binary_lens_magnification">
<span class="sig-name descname"><span class="pre">get_binary_lens_magnification</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MagnificationCurve.get_binary_lens_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the binary lens magnification.
If the shear or convergence are set, then they are used.</p>
<dl>
<dt>Allowed magnification methods (set by <a class="reference internal" href="#MulensModel.MagnificationCurve.set_magnification_methods" title="MulensModel.MagnificationCurve.set_magnification_methods"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_magnification_methods()</span></code></a>) :</dt><dd><dl>
<dt><code class="docutils literal notranslate"><span class="pre">point_source</span></code>:</dt><dd><p>standard point source magnification calculation.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">quadrupole</span></code>:</dt><dd><p>From <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008ApJ...681.1593G/abstract">Gould 2008 ApJ, 681, 1593</a>.
See
<code class="xref py py-func docutils literal notranslate"><span class="pre">hexadecapole_magnification()</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">hexadecapole</span></code>:</dt><dd><p>From <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008ApJ...681.1593G/abstract">Gould 2008 ApJ, 681, 1593</a> See
<code class="xref py py-func docutils literal notranslate"><span class="pre">hexadecapole_magnification()</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">VBBL</span></code>:</dt><dd><p>Uses VBBinaryLensing (a Stokes theorem/contour
integration code) by Valerio Bozza
(<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2010MNRAS.408.2188B/abstract">Bozza 2010 MNRAS, 408, 2188</a>).
See
<code class="xref py py-func docutils literal notranslate"><span class="pre">vbbl_magnification()</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Adaptive_Contouring</span></code>:</dt><dd><p>Uses AdaptiveContouring (a Stokes theorem/contour
integration code) by Martin Dominik
(<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2007MNRAS.377.1679D/abstract">Dominik 2007 MNRAS, 377, 1679</a>).
See
<code class="xref py py-func docutils literal notranslate"><span class="pre">adaptive_contouring_magnification()</span></code></p>
<p>Note that it doesn’t work if shear or convergence are set.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">point_source_point_lens</span></code>:</dt><dd><p>Uses point-source _point_-_lens_ approximation; useful when you
consider binary lens but need magnification very far from
the lens (e.g. at separation u = 100).</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>magnification: <em>np.ndarray</em></dt><dd><p>Vector of magnifications.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve.get_d_A_d_params">
<span class="sig-name descname"><span class="pre">get_d_A_d_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MagnificationCurve.get_d_A_d_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate d A / d parameters for a point lens model.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>parameters: <em>list</em></dt><dd><p>List of the parameters to take derivatives with respect to.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>dA_dparam: <em>dict</em></dt><dd><p>Keys are parameter names from <em>parameters</em> argument above.
Values are the partial derivatives for that parameter
evaluated at each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve.get_d_A_d_rho">
<span class="sig-name descname"><span class="pre">get_d_A_d_rho</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MagnificationCurve.get_d_A_d_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate d A / d rho for a point lens model.</p>
<p>No Inputs</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>dA_drho: <em>np.array</em></dt><dd><p>Values are the partial derivatives for rho
evaluated at each data point.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve.methods_for_epochs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">methods_for_epochs</span></span><a class="headerlink" href="#MulensModel.MagnificationCurve.methods_for_epochs" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em></p>
<p>for each epoch, decide which methods should be used to
calculate magnification, but don’t run the calculations</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MagnificationCurve.methods_indices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">methods_indices</span></span><a class="headerlink" href="#MulensModel.MagnificationCurve.methods_indices" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em></p>
<p>Keys are the magnification methods. Values are a boolean index that
indicate which epochs should be calculated with each method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ephemerides_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A Model for a microlensing event with the specified parameters.</p>
<dl>
<dt>Arguments :</dt><dd><p>parameters: <em>dictionary</em>,
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
<blockquote>
<div><p>see
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.modelparameters.ModelParameters</span></code></a></p>
</div></blockquote>
<p><a class="reference internal" href="#MulensModel.Model.coords" title="MulensModel.Model.coords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coords</span></code></a>: <em>str</em>, <em>astropy.SkyCoords</em>,
<em>MulensModel.Coordinates</em>, optional</p>
<blockquote>
<div><p>Sky coordinates of the event. If type is <em>str</em>, then it is
assumed that the units are hour angle and degrees for RA and Dec,
respectively.</p>
</div></blockquote>
<dl class="simple">
<dt>ra, dec: <em>str</em>, optional</dt><dd><p>Sky coordinates of the event.</p>
</dd>
<dt>ephemerides_file: <em>str</em>, optional</dt><dd><p>Specify name of the file with satellite ephemerides. See
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a> for more details.
Note that if you provide file name here, then it will affect
all calculations for this model. In most cases, you want to
combine ground-based and satellite data and in those cases set
ephemerides_file for specific
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a> instance
to pass satellite information.</p>
</dd>
</dl>
</dd>
<dt>Attributes :</dt><dd><dl class="simple">
<dt>ephemerides_file: <em>str</em></dt><dd><p>Name of file with satellite ephemerides.</p>
</dd>
</dl>
</dd>
</dl>
<p>Default values for parallax are all True. Use <a class="reference internal" href="#MulensModel.Model.parallax" title="MulensModel.Model.parallax"><code class="xref py py-func docutils literal notranslate"><span class="pre">parallax()</span></code></a>
to turn different parallax effects ON/OFF. If using satellite
parallax, you may also specify an <cite>ephemerides_file</cite> (see
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a>).</p>
<p>Note that you can print an instance of Model, which shows you parameters
in a nice way, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t_0&#39;</span><span class="p">:</span> <span class="mf">2456789.0</span><span class="p">,</span> <span class="o">....</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p>This will provide information on parameter values, coordinates,
methods used for magnification calculations, and
limb-darkening coefficients.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.plot_magnification">
<span class="sig-name descname"><span class="pre">plot_magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2450000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2460000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite_skycoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_flux_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.plot_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the model magnification curve.</p>
<dl>
<dt>Keywords :</dt><dd><p>see <a class="reference internal" href="#MulensModel.Model.plot_lc" title="MulensModel.Model.plot_lc"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_lc()</span></code></a></p>
<dl class="simple">
<dt>gamma:</dt><dd><p>see <a class="reference internal" href="#MulensModel.Model.get_magnification" title="MulensModel.Model.get_magnification"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_magnification()</span></code></a></p>
</dd>
<dt>satellite_skycoord:</dt><dd><p>see <a class="reference internal" href="#MulensModel.Model.plot_trajectory" title="MulensModel.Model.plot_trajectory"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_trajectory()</span></code></a></p>
</dd>
<dt>source_flux_ratio: <em>float</em></dt><dd><p>If the model has two sources, source_flux_ratio is the ratio of
source_flux_2 / source_flux_1</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>any arguments accepted by <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot()</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_lc">
<span class="sig-name descname"><span class="pre">get_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blend_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_flux_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate model light curve in magnitudes.</p>
<dl>
<dt>Keywords :</dt><dd><dl class="simple">
<dt>times: [<em>float</em>, <em>list</em>, <em>numpy.ndarray</em>]</dt><dd><p>a list of times at which to plot the magnifications</p>
</dd>
</dl>
<p>t_range, t_start, t_stop, dt, n_epochs: see <a class="reference internal" href="#MulensModel.Model.set_times" title="MulensModel.Model.set_times"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_times()</span></code></a></p>
<dl class="simple">
<dt>source_flux: <em>float</em> or <em>list</em></dt><dd><p>Explicitly specify the source flux(es) in a
system where flux = 1 corresponds to
<code class="xref py py-obj docutils literal notranslate"><span class="pre">MulensModel.utils.MAG_ZEROPOINT</span></code> (= 22 mag). If the model
has n_source &gt; 1, source_flux may be specified as a list: one
value for each source. Alternatively, if source_flux is
specified as a float, source_flux_ratio should also be
specified. Then, source_flux is taken to be the flux of the
first source, and the other source fluxes are derived using
source_flux_ratio.</p>
</dd>
<dt>blend_flux: <em>float</em></dt><dd><p>Explicitly specify the blend flux in a
system where flux = 1 corresponds to
<code class="xref py py-obj docutils literal notranslate"><span class="pre">MulensModel.utils.MAG_ZEROPOINT</span></code> (= 22 mag).</p>
</dd>
<dt>source_flux_ratio: <em>float</em>, Optional</dt><dd><p>If the model has two sources, source_flux_ratio is the ratio of
source_flux_2 / source_flux_1.</p>
</dd>
<dt>gamma, bandpass:</dt><dd><p>see <a class="reference internal" href="#MulensModel.Model.get_magnification" title="MulensModel.Model.get_magnification"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_magnification()</span></code></a></p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>magnitudes: <em>numpy.ndarray</em></dt><dd><p>Magnitude values for each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.plot_lc">
<span class="sig-name descname"><span class="pre">plot_lc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blend_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_flux_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2450000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2460000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phot_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mag'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.plot_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the model light curve in magnitudes.</p>
<dl class="simple">
<dt>Keywords :</dt><dd><dl class="simple">
<dt>times: [<em>float</em>, <em>list</em>, <em>numpy.ndarray</em>]</dt><dd><p>a list of times at which to plot the magnifications</p>
</dd>
<dt>t_range, t_start, t_stop, dt, n_epochs:</dt><dd><p>see <a class="reference internal" href="#MulensModel.Model.set_times" title="MulensModel.Model.set_times"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_times()</span></code></a></p>
</dd>
<dt>source_flux, blend_flux, source_flux_ratio:</dt><dd><p>see <a class="reference internal" href="#MulensModel.Model.get_lc" title="MulensModel.Model.get_lc"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_lc()</span></code></a></p>
</dd>
<dt>gamma, bandpass:</dt><dd><p>see <a class="reference internal" href="#MulensModel.Model.get_magnification" title="MulensModel.Model.get_magnification"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_magnification()</span></code></a></p>
</dd>
<dt>subtract_2450000, subtract_2460000: <em>boolean</em>, optional</dt><dd><p>If True, subtracts 2450000 or 2460000 from the time
axis to get more human-scale numbers. If using, make
sure to also set the same settings for all other
plotting calls (e.g. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_data()</span></code>)</p>
</dd>
<dt>phot_fmt: <em>str</em></dt><dd><p>Specifies whether the photometry is plotted in magnitude or
flux space. Accepts either ‘mag’ or ‘flux’. Default = ‘mag’.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>any arguments accepted by <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot()</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.plot_caustics">
<span class="sig-name descname"><span class="pre">plot_caustics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.plot_caustics" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the caustic structure. See
<code class="xref py py-func docutils literal notranslate"><span class="pre">MulensModel.caustics.Caustics.plot()</span></code> for binary lenses.
For a single lens it just marks (0, 0) point and
the first two parameters are ignored.</p>
<dl class="simple">
<dt>Additional parameters :</dt><dd><dl class="simple">
<dt>n_points: <em>int</em>, optional</dt><dd><p>The number of points to calculate along the caustic.
Defaults to 5000.</p>
</dd>
<dt>epoch: <em>float</em>, optional</dt><dd><p>Epoch for which separation <em>s</em> will be used. Important
for models with orbital motion. Defaults to <em>t_0_kep</em>,
which defaults to <em>t_0</em>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>keywords accepted by <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.scatter()</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.update_caustics">
<span class="sig-name descname"><span class="pre">update_caustics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.update_caustics" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates <a class="reference internal" href="#MulensModel.Model.caustics" title="MulensModel.Model.caustics"><code class="xref py py-attr docutils literal notranslate"><span class="pre">caustics</span></code></a> property for given epoch.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>epoch: <em>float</em></dt><dd><p>For orbital motion models, epoch for which separation <em>s</em>
is calculated to calculate <a class="reference internal" href="#MulensModel.Model.caustics" title="MulensModel.Model.caustics"><code class="xref py py-attr docutils literal notranslate"><span class="pre">caustics</span></code></a>. Defaults
to <em>t_0_kep</em>, which defaults to <em>t_0</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.plot_trajectory">
<span class="sig-name descname"><span class="pre">plot_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caustics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite_skycoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrow_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.plot_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the source trajectory.</p>
<p>Keywords (all optional) :</p>
<blockquote>
<div><dl class="simple">
<dt>times, t_range, t_start, t_stop, dt, n_epochs:</dt><dd><p>May all be used to specify exactly when to plot the
source trajectory. See also <a class="reference internal" href="#MulensModel.Model.plot_lc" title="MulensModel.Model.plot_lc"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_lc()</span></code></a> and
<a class="reference internal" href="#MulensModel.Model.set_times" title="MulensModel.Model.set_times"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_times()</span></code></a>.</p>
</dd>
<dt>caustics: <em>boolean</em></dt><dd><p>plot the caustic structure in addition to the source
trajectory. default=False (off). For finer control of
plotting features, e.g. color, use <a class="reference internal" href="#MulensModel.Model.plot_caustics" title="MulensModel.Model.plot_caustics"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_caustics()</span></code></a>
instead.</p>
</dd>
<dt>arrow: <em>boolean</em></dt><dd><p>Show the direction of the source motion. Default is <em>True</em>.</p>
</dd>
</dl>
<p>satellite_skycoord: <em>astropy.SkyCoord</em> or
<a class="reference internal" href="MulensModel.satelliteskycoord.html#MulensModel.satelliteskycoord.SatelliteSkyCoord" title="MulensModel.satelliteskycoord.SatelliteSkyCoord"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.satelliteskycoord.SatelliteSkyCoord</span></code></a></p>
<blockquote>
<div><p>Allows the user to specify that the trajectory is calculated
for a satellite. If <em>astropy.SkyCoord</em> object is provided,
then these are satellite positions for all epochs.
See also <a class="reference internal" href="#MulensModel.Model.get_satellite_coords" title="MulensModel.Model.get_satellite_coords"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_satellite_coords()</span></code></a></p>
</div></blockquote>
<dl class="simple">
<dt>arrow_kwargs: <em>dict</em></dt><dd><p>Kwargs that are passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">pyplot.arrow()</span></code>. If no
color is given here, then we use one specified in <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>
and if nothing is there, then we use black. The size of
the arrow is determined based on limits of current axis.
If those are not adequate, then change the size by specifying
<em>width</em> keyword and maybe other as well. Note that
<em>arrow_kwargs</em> are of <em>dict</em> type and are different than
<code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></dt><dd><p>Controls plotting features of the trajectory. It’s passed to
<code class="xref py py-func docutils literal notranslate"><span class="pre">pyplot.plot()</span></code>.</p>
</dd>
</dl>
</div></blockquote>
<p>Note that in order to have equal scaling of both axis
(i.e., make circles look circular), you have to call appropriate
<em>pyplot</em> command. This can be one of these commands:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;scaled&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>They have slightly different behavior.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.plot_source">
<span class="sig-name descname"><span class="pre">plot_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.plot_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot source: circles of the radius rho at positions corresponding to
source positions at times. When the rho is not defined, then X symbols
are plotted.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>times: <em>float</em> or <em>np.ndarray</em></dt><dd><p>epochs for which source positions will be plotted</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>Keyword arguments passed to <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.patches.Circle.html">matplotlib.Circle</a>.
Examples: <code class="docutils literal notranslate"><span class="pre">color='red'</span></code>, <code class="docutils literal notranslate"><span class="pre">fill=False</span></code>,
<code class="docutils literal notranslate"><span class="pre">linewidth=3</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha=0.5</span></code>. When the rho is not defined,
then keyword arguments are passed to <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html">matplotlib.plot</a>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Note that it is likely that with default axis scaling, the circles may
be plotted as ellipses. To mitigate it, use:
<code class="docutils literal notranslate"><span class="pre">plt.gca().set_aspect('equal')</span></code> or <code class="docutils literal notranslate"><span class="pre">plt.axis('equal')</span></code>
(the other possible options are <code class="docutils literal notranslate"><span class="pre">'scaled'</span></code> or <code class="docutils literal notranslate"><span class="pre">'square'</span></code>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_trajectory">
<span class="sig-name descname"><span class="pre">get_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite_skycoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the trajectory of the source for the given set of times.
For multi-source models, one trajectory per source is returned.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>times:  <em>np.ndarray</em>, <em>list of floats</em>, or <em>float</em></dt><dd><p>Epochs for which source positions are requested.</p>
</dd>
<dt>satellite_skycoord: <em>astropy.SkyCoord</em></dt><dd><p>Allows the user to specify that the trajectory is calculated
for a satellite. If <em>astropy.SkyCoord</em> object is provided,
then these are satellite positions for all epochs.
See also <a class="reference internal" href="#MulensModel.Model.get_satellite_coords" title="MulensModel.Model.get_satellite_coords"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_satellite_coords()</span></code></a></p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>trajectories: <cite>:py:class:`~MulensModel.trajectory.Trajectory</cite> object or a <em>list</em> of them</dt><dd><p>Single object for single source model, a <em>list</em> otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.set_times">
<span class="sig-name descname"><span class="pre">set_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.set_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of times. If no keywords are specified, default
is 1000 epochs from [<span class="math notranslate nohighlight">\(t_0 - 1.5 * t_E\)</span>, <span class="math notranslate nohighlight">\(t_0 + 1.5 * t_E\)</span>]
range.</p>
<p>For multi-source models, respectively, minimum and maximum of
<cite>t_0_N</cite> values are used.</p>
<dl class="simple">
<dt>Parameters (all optional):</dt><dd><dl class="simple">
<dt>t_range: [<em>list</em>, <em>tuple</em>]</dt><dd><p>A range of times of the form [t_start, t_stop]</p>
</dd>
<dt>t_start, t_stop: <em>float</em></dt><dd><p>a start or stop time.</p>
</dd>
<dt>dt: <em>float</em></dt><dd><p>the interval spacing between successive points</p>
</dd>
<dt>n_epochs: <em>int</em></dt><dd><p>the number of epochs (evenly spaced)</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>times: <em>np.ndarray</em></dt><dd><p>Vector of epochs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.set_magnification_methods">
<span class="sig-name descname"><span class="pre">set_magnification_methods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.set_magnification_methods" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets methods used for magnification calculation. See
<a class="reference internal" href="MulensModel.magnificationcurve.html#MulensModel.magnificationcurve.MagnificationCurve" title="MulensModel.magnificationcurve.MagnificationCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagnificationCurve</span></code></a>
for a list of implemented methods.</p>
<dl>
<dt>Parameters :</dt><dd><dl>
<dt>methods: <em>list</em></dt><dd><p>List that specifies which methods (<em>str</em>) should be
used when (<em>float</em> values for Julian dates). Given
method will be used for times between the times
between which it is on the list, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">2455746.</span><span class="p">,</span> <span class="s1">&#39;Quadrupole&#39;</span><span class="p">,</span> <span class="mf">2455746.6</span><span class="p">,</span> <span class="s1">&#39;Hexadecapole&#39;</span><span class="p">,</span>
    <span class="mf">2455746.7</span><span class="p">,</span> <span class="s1">&#39;VBBL&#39;</span><span class="p">,</span> <span class="mf">2455747.</span><span class="p">,</span> <span class="s1">&#39;Hexadecapole&#39;</span><span class="p">,</span>
    <span class="mf">2455747.15</span><span class="p">,</span> <span class="s1">&#39;Quadrupole&#39;</span><span class="p">,</span> <span class="mf">2455748.</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt>source: <em>int</em> or <em>None</em>, optional</dt><dd><p>Which source do the given methods apply to? Accepts 1, 2, or
<em>None</em> (i.e., all sources). Default is <em>None</em></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_magnification_methods">
<span class="sig-name descname"><span class="pre">get_magnification_methods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_magnification_methods" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets methods used for magnification calculation. See
<a class="reference internal" href="#MulensModel.Model.set_magnification_methods" title="MulensModel.Model.set_magnification_methods"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_magnification_methods()</span></code></a></p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>source: <em>int</em> or <em>None</em>, optional</dt><dd><p>Which source do the given methods apply to? Accepts 1, 2, or
<em>None</em> (i.e., all sources). Default is <em>None</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Model.methods">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">methods</span></span><a class="headerlink" href="#MulensModel.Model.methods" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> of methods used for magnification calculation or <em>dict</em> of
<em>lists</em> if there are multiple sources.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Model.default_magnification_method">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_magnification_method</span></span><a class="headerlink" href="#MulensModel.Model.default_magnification_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores information on method to be used, when no method is
directly specified. See
<a class="reference internal" href="MulensModel.magnificationcurve.html#MulensModel.magnificationcurve.MagnificationCurve" title="MulensModel.magnificationcurve.MagnificationCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagnificationCurve</span></code></a>
for a list of implemented methods.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>method: <em>str</em></dt><dd><p>Name of the method to be used.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.set_magnification_methods_parameters">
<span class="sig-name descname"><span class="pre">set_magnification_methods_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methods_parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.set_magnification_methods_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Set additional parameters for magnification calculation methods.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>methods_parameters: <em>dict</em></dt><dd><p>Dictionary that for method names (keys) returns dictionary
in the form of <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> that are passed to given method,
e.g., <code class="docutils literal notranslate"><span class="pre">{'VBBL':</span> <span class="pre">{'accuracy':</span> <span class="pre">0.005}}</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_magnification_methods_parameters">
<span class="sig-name descname"><span class="pre">get_magnification_methods_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_magnification_methods_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get additional parameters for a specific magnification calculation
method or methods.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>method: <em>str</em>, <em>list</em></dt><dd><p>Name of method or a list of the names for which parameters
will be returned.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>method_parameters: <em>dict</em></dt><dd><p>see <a class="reference internal" href="#MulensModel.Model.set_magnification_methods_parameters" title="MulensModel.Model.set_magnification_methods_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_magnification_methods_parameters()</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.set_limb_coeff_gamma">
<span class="sig-name descname"><span class="pre">set_limb_coeff_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.set_limb_coeff_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Store gamma limb darkening coefficient for given band. See
also
<a class="reference internal" href="MulensModel.limbdarkeningcoeffs.html#MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs" title="MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbDarkeningCoeffs</span></code></a>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bandpass: <em>str</em></dt><dd><p>Bandpass for the coefficient you provide.</p>
</dd>
<dt>coeff: <em>float</em></dt><dd><p>Value of the coefficient.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_limb_coeff_gamma">
<span class="sig-name descname"><span class="pre">get_limb_coeff_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_limb_coeff_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Get gamma limb darkening coefficient for given band.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bandpass: <em>str</em></dt><dd><p>Bandpass for which coefficient will be provided.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>gamma: <em>float</em></dt><dd><p>limb darkening coefficient</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.set_limb_coeff_u">
<span class="sig-name descname"><span class="pre">set_limb_coeff_u</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.set_limb_coeff_u" title="Permalink to this definition">¶</a></dt>
<dd><p>Store u limb darkening coefficient for given band.  See also
<a class="reference internal" href="MulensModel.limbdarkeningcoeffs.html#MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs" title="MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs</span></code></a>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bandpass: <em>str</em></dt><dd><p>Bandpass for which coefficient you provide.</p>
</dd>
<dt>coeff: <em>float</em></dt><dd><p>Value of the coefficient.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_limb_coeff_u">
<span class="sig-name descname"><span class="pre">get_limb_coeff_u</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bandpass</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_limb_coeff_u" title="Permalink to this definition">¶</a></dt>
<dd><p>Get u limb darkening coefficient for given band.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>bandpass: <em>str</em></dt><dd><p>Bandpass for which coefficient will be provided.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>u: <em>float</em></dt><dd><p>limb darkening coefficient</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.parallax">
<span class="sig-name descname"><span class="pre">parallax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">earth_orbital</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topocentric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.parallax" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies the types of the microlensing parallax that will be
included in calculations.</p>
<p>Parameters :</p>
<blockquote>
<div><dl class="simple">
<dt>earth_orbital: <em>boolean</em>, optional</dt><dd><p>Do you want to include the effect of Earth motion about
the Sun? Default is <em>False</em>.</p>
</dd>
<dt>satellite: <em>boolean</em>, optional</dt><dd><p>Do you want to include the effect of difference due to
separation between the Earth and satellite? Note that this
separation changes over time. Default is <em>False</em>.</p>
</dd>
<dt>topocentric: <em>boolean</em>, optional</dt><dd><p>Do you want to include the effect of different positions
of observatories on the Earth? Default is <em>False</em>.
Note that this is significant only for very high magnification
events and if high quality datasets are analyzed.
Hence, this effect is rarely needed. <strong>Not Implemented yet.</strong></p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_parallax">
<span class="sig-name descname"><span class="pre">get_parallax</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_parallax" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <em>dict</em> that specifies the types of the microlensing parallax
that are included in calculations.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>parallax: <em>dict</em></dt><dd><p>For keys <code class="docutils literal notranslate"><span class="pre">'earth_orbital'</span></code>, <code class="docutils literal notranslate"><span class="pre">'satellite'</span></code>,
and <code class="docutils literal notranslate"><span class="pre">'topocentric'</span></code> returns <em>bool</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_satellite_coords">
<span class="sig-name descname"><span class="pre">get_satellite_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_satellite_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Get <em>astropy.SkyCoord</em> object that gives satellite positions
for given times. see also
<a class="reference internal" href="MulensModel.satelliteskycoord.html#MulensModel.satelliteskycoord.SatelliteSkyCoord" title="MulensModel.satelliteskycoord.SatelliteSkyCoord"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.satelliteskycoord.SatelliteSkyCoord</span></code></a></p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>times: <em>np.ndarray</em> or <em>list</em></dt><dd><p>Epochs for which satellite position is requested.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>satellite_skycoord: <em>astropy.SkyCoord</em></dt><dd><p><em>SkyCoord</em> giving satellite positions. The parameter
<em>representation</em> is set to ‘spherical’. If
<cite>ephemerides_file</cite> is not set, returns <em>None</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_magnification">
<span class="sig-name descname"><span class="pre">get_magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite_skycoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_flux_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the model magnification for the given time(s).</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>time: <em>np.ndarray</em>, <em>list of floats</em>, or <em>float</em></dt><dd><p>Times for which magnification values are requested.</p>
</dd>
<dt>satellite_skycoord: <em>astropy.coordinates.SkyCoord</em>, optional</dt><dd><p><em>SkyCoord</em> object that gives satellite positions. Must be
the same length as time parameter. Use only for satellite
parallax calculations.</p>
</dd>
<dt>gamma: <em>float</em>, optional</dt><dd><p>The limb-darkening coefficient in gamma convention. Default is
0 which means no limb darkening effect.</p>
</dd>
<dt>bandpass: <em>str</em>, optional</dt><dd><p>The bandpass for setting the limb-darkening coefficient.
Expects that you have used <a class="reference internal" href="#MulensModel.Model.set_limb_coeff_gamma" title="MulensModel.Model.set_limb_coeff_gamma"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_limb_coeff_gamma()</span></code></a> or
<a class="reference internal" href="#MulensModel.Model.set_limb_coeff_u" title="MulensModel.Model.set_limb_coeff_u"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_limb_coeff_u()</span></code></a>. Only ONE of ‘gamma’ or
‘bandpass’ may be specified.</p>
</dd>
<dt>source_flux_ratio: <em>float</em>, <em>list</em></dt><dd><p>If the model has 2 sources, source_flux_ratio is the ratio of
source_flux_2 / source_flux_1. For N sources, source_flux_ratio a list
of the ratios of source_flux_i / source_flux_1 where i = 2, N.</p>
</dd>
<dt>separate: <em>boolean</em>, optional</dt><dd><p>For multi source models, return magnification of each source
separately. Defaults to <em>True</em> if source_flux_ratio is provided and <em>False</em> otherwise
(then only effective magnification is returned).</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>magnification: <em>np.ndarray</em></dt><dd><p>A vector of calculated magnification values. For binary source
models, the effective magnification is returned (unless
<em>separate=True</em>).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_magnification_curve">
<span class="sig-name descname"><span class="pre">get_magnification_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite_skycoord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_magnification_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="MulensModel.magnificationcurve.html#MulensModel.magnificationcurve.MagnificationCurve" title="MulensModel.magnificationcurve.MagnificationCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagnificationCurve</span></code></a>
object for a given set of times.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>time: <em>np.ndarray</em>, <em>list of floats</em>, or <em>float</em></dt><dd><p>Times for which magnification values are requested.</p>
</dd>
<dt>satellite_skycoord: <em>astropy.coordinates.SkyCoord</em>, optional</dt><dd><p><em>SkyCoord</em> object that gives satellite positions. Must be
the same length as time parameter. Use only for satellite
parallax calculations.</p>
</dd>
<dt>gamma: <em>float</em>, optional</dt><dd><p>The limb-darkening coefficient in gamma convention. Default is
0 which means no limb darkening effect.</p>
</dd>
</dl>
</dd>
<dt>Return:</dt><dd><p>py:class:<cite>~MulensModel.magnificationcurve.MagnificationCurve</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.get_magnification_curves">
<span class="sig-name descname"><span class="pre">get_magnification_curves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite_skycoord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.get_magnification_curves" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <em>list</em> of
<a class="reference internal" href="MulensModel.magnificationcurve.html#MulensModel.magnificationcurve.MagnificationCurve" title="MulensModel.magnificationcurve.MagnificationCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">MagnificationCurve</span></code></a>
objects for multiple sources, given a set of times.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>time: <em>np.ndarray</em>, <em>list of floats</em>, or <em>float</em></dt><dd><p>Times for which magnification values are requested.</p>
</dd>
<dt>satellite_skycoord: <em>astropy.coordinates.SkyCoord</em>, optional</dt><dd><p><em>SkyCoord</em> object that gives satellite positions. Must be
the same length as time parameter. Use only for satellite
parallax calculations.</p>
</dd>
<dt>gamma: <em>float</em>, optional</dt><dd><p>The limb-darkening coefficient in gamma convention. Default is
0 which means no limb darkening effect.</p>
</dd>
</dl>
</dd>
<dt>Return:</dt><dd><p><em>list</em> of
py:class:<cite>~MulensModel.magnificationcurve.MagnificationCurve</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Model.caustics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">caustics</span></span><a class="headerlink" href="#MulensModel.Model.caustics" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Caustics</span></code></p>
<p>Caustics for given model</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Model.parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters</span></span><a class="headerlink" href="#MulensModel.Model.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
<p>Model parameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Model.n_lenses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_lenses</span></span><a class="headerlink" href="#MulensModel.Model.n_lenses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>number of objects in the lens system</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Model.n_sources">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_sources</span></span><a class="headerlink" href="#MulensModel.Model.n_sources" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>number of luminous sources; it’s possible to be 1 for xallarap model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Model.is_static">
<span class="sig-name descname"><span class="pre">is_static</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Model.is_static" title="Permalink to this definition">¶</a></dt>
<dd><p>see <a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters.is_static" title="MulensModel.modelparameters.ModelParameters.is_static"><code class="xref py py-func docutils literal notranslate"><span class="pre">MulensModel.modelparameters.ModelParameters.is_static()</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Model.coords">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coords</span></span><a class="headerlink" href="#MulensModel.Model.coords" title="Permalink to this definition">¶</a></dt>
<dd><p>see <a class="reference internal" href="MulensModel.coordinates.html#MulensModel.coordinates.Coordinates" title="MulensModel.coordinates.Coordinates"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coordinates</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Model.bandpasses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bandpasses</span></span><a class="headerlink" href="#MulensModel.Model.bandpasses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em></p>
<p>List of all bandpasses for which limb darkening coefficients are set.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.ModelParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">ModelParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.ModelParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class for the basic microlensing model parameters (t_0, u_0,
t_E, s, q, alpha, etc.). Can handle point lens or binary lens.
The pi_E assumes NE coordinates (Parallel, Perpendicular
coordinates are not supported).</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>parameters: <em>dictionary</em></dt><dd><p>A dictionary of parameters and their values. See
<code class="xref py py-func docutils literal notranslate"><span class="pre">which_parameters()</span></code> for valid parameter combinations.</p>
</dd>
</dl>
</dd>
<dt>Attributes :</dt><dd><dl class="simple">
<dt>parameters: <em>dictionary</em></dt><dd><p>A dictionary of parameters and their values. Do not use it to
change parameter values, instead use e.g.:
<code class="docutils literal notranslate"><span class="pre">model_parameters.u_0</span> <span class="pre">=</span> <span class="pre">0.1</span></code> or
<code class="docutils literal notranslate"><span class="pre">setattr(model_parameters,</span> <span class="pre">'u_0',</span> <span class="pre">0.1)</span></code>.</p>
</dd>
</dl>
</dd>
<dt>Example:</dt><dd><dl class="simple">
<dt>Define a point lens model:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">params</span> <span class="pre">=</span> <span class="pre">ModelParameters({'t_0':</span> <span class="pre">2450000.,</span> <span class="pre">'u_0':</span> <span class="pre">0.3,</span>
<span class="pre">'t_E':</span> <span class="pre">35.})</span></code></p>
</dd>
<dt>Then you can print the parameters:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">print(params)</span></code></p>
</dd>
</dl>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_0</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_0" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The time of minimum projected separation between the source
and the lens center of mass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.u_0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">u_0</span></span><a class="headerlink" href="#MulensModel.ModelParameters.u_0" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The minimum projected separation between the source
and the lens center of mass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_star">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_star</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_star" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>t_star = rho * t_E = source radius crossing time in days</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_eff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_eff</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_eff" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>t_eff = u_0 * t_E = effective timescale in days</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_E</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_E" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The Einstein timescale in days.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.rho">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rho</span></span><a class="headerlink" href="#MulensModel.ModelParameters.rho" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>source size as a fraction of the Einstein radius</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.alpha">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#MulensModel.ModelParameters.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The angle of the source trajectory relative to the binary lens
axis (or primary-secondary axis). Measured counterclockwise,
i.e., according to convention advocated by
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2011ApJ...738...87S/abstract">Skowron et al. 2011 (ApJ, 738, 87)</a>,
but shifted by 180 deg.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.q">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">q</span></span><a class="headerlink" href="#MulensModel.ModelParameters.q" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>mass ratio of the two lens components. Only 2 bodies allowed.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.convergence_K">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convergence_K</span></span><a class="headerlink" href="#MulensModel.ModelParameters.convergence_K" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Convergence of external mass sheet.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.shear_G">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shear_G</span></span><a class="headerlink" href="#MulensModel.ModelParameters.shear_G" title="Permalink to this definition">¶</a></dt>
<dd><p><em>complex</em></p>
<p>Shear of external mass sheet.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.s">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#MulensModel.ModelParameters.s" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>separation of the two lens components relative to Einstein ring size</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.pi_E_N">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pi_E_N</span></span><a class="headerlink" href="#MulensModel.ModelParameters.pi_E_N" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The North component of the microlensing parallax vector.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.pi_E_E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pi_E_E</span></span><a class="headerlink" href="#MulensModel.ModelParameters.pi_E_E" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The East component of the microlensing parallax vector.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.pi_E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pi_E</span></span><a class="headerlink" href="#MulensModel.ModelParameters.pi_E" title="Permalink to this definition">¶</a></dt>
<dd><p>Not defined.</p>
<p>It was used in previous versions. Use <a class="reference internal" href="#MulensModel.ModelParameters.pi_E_N" title="MulensModel.ModelParameters.pi_E_N"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pi_E_N</span></code></a> and <a class="reference internal" href="#MulensModel.ModelParameters.pi_E_E" title="MulensModel.ModelParameters.pi_E_E"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pi_E_E</span></code></a> instead.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_0_par">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_0_par</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_0_par" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The reference time for the calculation of parallax. If not set
explicitly, then it is assumed t_0_par = t_0. If there are multiple sources,
t_0_1 is used.</p>
<p>Note that this is a reference value and not the fitting parameter.
It is best to fix it at the begin of calculations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.pi_E_mag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pi_E_mag</span></span><a class="headerlink" href="#MulensModel.ModelParameters.pi_E_mag" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The magnitude of the microlensing parallax vector.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.x_caustic_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x_caustic_in</span></span><a class="headerlink" href="#MulensModel.ModelParameters.x_caustic_in" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Curvelinear coordinate (in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008A%26A...491..587C/abstract">Cassan (2008) parameterization</a>)
of caustic entrance for a static binary lens model. See
<a class="reference internal" href="MulensModel.uniformcausticsampling.html#MulensModel.uniformcausticsampling.UniformCausticSampling" title="MulensModel.uniformcausticsampling.UniformCausticSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniformCausticSampling</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.x_caustic_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x_caustic_out</span></span><a class="headerlink" href="#MulensModel.ModelParameters.x_caustic_out" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Curvelinear coordinate (in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008A%26A...491..587C/abstract">Cassan (2008) parameterization</a>)
of caustic exit for a static binary lens model. See
<a class="reference internal" href="MulensModel.uniformcausticsampling.html#MulensModel.uniformcausticsampling.UniformCausticSampling" title="MulensModel.uniformcausticsampling.UniformCausticSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniformCausticSampling</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_caustic_in">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_caustic_in</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_caustic_in" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Epoch of caustic entrance for a static binary lens model in
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008A%26A...491..587C/abstract">Cassan (2008) parameterization</a>)
See
<a class="reference internal" href="MulensModel.uniformcausticsampling.html#MulensModel.uniformcausticsampling.UniformCausticSampling" title="MulensModel.uniformcausticsampling.UniformCausticSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniformCausticSampling</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_caustic_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_caustic_out</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_caustic_out" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Epoch of caustic exit for a static binary lens model in
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008A%26A...491..587C/abstract">Cassan (2008) parameterization</a>)
See
<a class="reference internal" href="MulensModel.uniformcausticsampling.html#MulensModel.uniformcausticsampling.UniformCausticSampling" title="MulensModel.uniformcausticsampling.UniformCausticSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniformCausticSampling</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.ds_dt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ds_dt</span></span><a class="headerlink" href="#MulensModel.ModelParameters.ds_dt" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Change rate of separation <a class="reference internal" href="#MulensModel.ModelParameters.s" title="MulensModel.ModelParameters.s"><code class="xref py py-attr docutils literal notranslate"><span class="pre">s</span></code></a> in 1/year.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.dalpha_dt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dalpha_dt</span></span><a class="headerlink" href="#MulensModel.ModelParameters.dalpha_dt" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Change rate of angle <a class="reference internal" href="#MulensModel.ModelParameters.alpha" title="MulensModel.ModelParameters.alpha"><code class="xref py py-attr docutils literal notranslate"><span class="pre">alpha</span></code></a> in deg/year.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_0_kep">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_0_kep</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_0_kep" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The reference time for the calculation of lens orbital motion.
If not set explicitly, then it is assumed t_0_kep = t_0 (or t_0_1 for multi-source models).</p>
<p>Note that this is a reference value and not the fitting parameter.
It is best to fix it at the begin of calculations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.xi_period">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xi_period</span></span><a class="headerlink" href="#MulensModel.ModelParameters.xi_period" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Orbital period of the source system (xallarap) in days.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.xi_semimajor_axis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xi_semimajor_axis</span></span><a class="headerlink" href="#MulensModel.ModelParameters.xi_semimajor_axis" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Semi-major axis of the source orbit (xallarap) in the theta_E units.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.xi_Omega_node">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xi_Omega_node</span></span><a class="headerlink" href="#MulensModel.ModelParameters.xi_Omega_node" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The longitude of the ascending node of the xallarap orbit, i.e.,
the angle from relative lens-source proper motion direction
to the ascending node direction.
The units are degrees.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.xi_inclination">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xi_inclination</span></span><a class="headerlink" href="#MulensModel.ModelParameters.xi_inclination" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The inclination of the xallarap orbit, i.e.,
the angle between source-orbit plane and the sky plane.
The units are degrees.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.xi_argument_of_latitude_reference">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xi_argument_of_latitude_reference</span></span><a class="headerlink" href="#MulensModel.ModelParameters.xi_argument_of_latitude_reference" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The argument of latitude for the xallarap orbit at <a class="reference internal" href="#MulensModel.ModelParameters.t_0_xi" title="MulensModel.ModelParameters.t_0_xi"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_0_xi</span></code></a>.
The argument of latitude is a sum of the true anomaly and
the argument of periapsis. In standard notation: u = nu + omega.
This parameter is internally used to calculate perihelion passage
(T_0 in standard notation).
The units are degrees.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.xi_eccentricity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xi_eccentricity</span></span><a class="headerlink" href="#MulensModel.ModelParameters.xi_eccentricity" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The eccentricity of the xallarap orbit. Has to be in [0, 1) range.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.xi_omega_periapsis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xi_omega_periapsis</span></span><a class="headerlink" href="#MulensModel.ModelParameters.xi_omega_periapsis" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The argument of periapsis of the xallarap orbit, i.e., the angle
between the ascending node and periapsis measured in
the direction of motion.
The units are degrees.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_0_xi">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_0_xi</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_0_xi" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Reference epoch for xallarap orbit.
If not provided, then it defaults to <a class="reference internal" href="#MulensModel.ModelParameters.t_0" title="MulensModel.ModelParameters.t_0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_0</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.q_source">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">q_source</span></span><a class="headerlink" href="#MulensModel.ModelParameters.q_source" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The mass ratio of the second and the first source.
This is value must be positive and can be &gt; 1.
Defined only for xallarap binary-source models because it does not
affect the magnification for binary-source models without xallarap.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.xallarap_reference_position">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xallarap_reference_position</span></span><a class="headerlink" href="#MulensModel.ModelParameters.xallarap_reference_position" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em> of shape (2, 1)</p>
<p>The position of the first source at <a class="reference internal" href="#MulensModel.ModelParameters.t_0_xi" title="MulensModel.ModelParameters.t_0_xi"><code class="xref py py-attr docutils literal notranslate"><span class="pre">t_0_xi</span></code></a> relative to
the source center of mass. It is a 2D vector that is subtracted from
the source position along the orbit in order to calculate the shift
caused by xallarap.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_0_1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_0_1</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_0_1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The time of minimum projected separation between the source no. 1
and the lens center of mass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_0_2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_0_2</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_0_2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The time of minimum projected separation between the source no. 2
and the lens center of mass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.u_0_1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">u_0_1</span></span><a class="headerlink" href="#MulensModel.ModelParameters.u_0_1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The minimum projected separation between the source no. 1
and the lens center of mass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.u_0_2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">u_0_2</span></span><a class="headerlink" href="#MulensModel.ModelParameters.u_0_2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The minimum projected separation between the source no. 2
and the lens center of mass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_star_1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_star_1</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_star_1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>t_star_1 = rho_1 * t_E_1 = source no. 1 radius crossing time in days</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.t_star_2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_star_2</span></span><a class="headerlink" href="#MulensModel.ModelParameters.t_star_2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>t_star_2 = rho_2 * t_E_2 = source no. 2 radius crossing time in days.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.rho_1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rho_1</span></span><a class="headerlink" href="#MulensModel.ModelParameters.rho_1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>source no. 1 size as a fraction of the Einstein radius</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.rho_2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rho_2</span></span><a class="headerlink" href="#MulensModel.ModelParameters.rho_2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>source no. 2 size as a fraction of the Einstein radius</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.get_s">
<span class="sig-name descname"><span class="pre">get_s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.ModelParameters.get_s" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of separation <a class="reference internal" href="#MulensModel.ModelParameters.s" title="MulensModel.ModelParameters.s"><code class="xref py py-attr docutils literal notranslate"><span class="pre">s</span></code></a> at a given epoch or
epochs (if orbital motion parameters are set).</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>epoch: <em>float</em>, <em>list</em>, <em>np.ndarray</em></dt><dd><p>The time(s) at which to calculate <a class="reference internal" href="#MulensModel.ModelParameters.s" title="MulensModel.ModelParameters.s"><code class="xref py py-attr docutils literal notranslate"><span class="pre">s</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>separation: <em>float</em> or <em>np.ndarray</em></dt><dd><p>Value(s) of separation for given epochs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.get_alpha">
<span class="sig-name descname"><span class="pre">get_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.ModelParameters.get_alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of angle <a class="reference internal" href="#MulensModel.ModelParameters.alpha" title="MulensModel.ModelParameters.alpha"><code class="xref py py-attr docutils literal notranslate"><span class="pre">alpha</span></code></a> at a given epoch or
epochs (if orbital motion parameters are set).</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>epoch: <em>float</em>, <em>list</em>, <em>np.ndarray</em></dt><dd><p>The time(s) at which to calculate <a class="reference internal" href="#MulensModel.ModelParameters.alpha" title="MulensModel.ModelParameters.alpha"><code class="xref py py-attr docutils literal notranslate"><span class="pre">alpha</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>angle: <em>float</em></dt><dd><p>Value(s) of angle for given epochs in degrees</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.gamma_parallel">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gamma_parallel</span></span><a class="headerlink" href="#MulensModel.ModelParameters.gamma_parallel" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Parallel component of instantaneous velocity of the secondary
relative to the primary in 1/year.
It is parallel to the primary-secondary axis.
Equals <a class="reference internal" href="#MulensModel.ModelParameters.ds_dt" title="MulensModel.ModelParameters.ds_dt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ds_dt</span></code></a>/<a class="reference internal" href="#MulensModel.ModelParameters.s" title="MulensModel.ModelParameters.s"><code class="xref py py-attr docutils literal notranslate"><span class="pre">s</span></code></a>. Cannot be set.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.gamma_perp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gamma_perp</span></span><a class="headerlink" href="#MulensModel.ModelParameters.gamma_perp" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Perpendicular component of instantaneous velocity of the secondary
relative to the primary. It is perpendicular to the primary-secondary
axis. It has sign opposite to <a class="reference internal" href="#MulensModel.ModelParameters.dalpha_dt" title="MulensModel.ModelParameters.dalpha_dt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dalpha_dt</span></code></a>
and is in rad/yr, not deg/yr. Cannot be set.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.gamma">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gamma</span></span><a class="headerlink" href="#MulensModel.ModelParameters.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Instantaneous velocity of the secondary relative to the primary in
1/year. Cannot be set.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.is_finite_source">
<span class="sig-name descname"><span class="pre">is_finite_source</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.ModelParameters.is_finite_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if model has finite source. For binary source models it checks
if either of the sources is finite.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>is_finite_source: <em>boolean</em></dt><dd><p><em>True</em> if at least one source has finite size.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.is_static">
<span class="sig-name descname"><span class="pre">is_static</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.ModelParameters.is_static" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if model is static, i.e., orbital motion parameters are not set.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>is_static: <em>boolean</em></dt><dd><p><em>True</em> if <em>dalpha_dt</em> or <em>ds_dt</em> are set.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.n_lenses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_lenses</span></span><a class="headerlink" href="#MulensModel.ModelParameters.n_lenses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>Number of objects in the lens system.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.n_sources">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_sources</span></span><a class="headerlink" href="#MulensModel.ModelParameters.n_sources" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>Number of luminous sources.
It can be be 1 for a xallarap model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.is_external_mass_sheet">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_external_mass_sheet</span></span><a class="headerlink" href="#MulensModel.ModelParameters.is_external_mass_sheet" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em></p>
<p>Whether an external mass sheet is included in the model</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.is_external_mass_sheet_with_shear">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_external_mass_sheet_with_shear</span></span><a class="headerlink" href="#MulensModel.ModelParameters.is_external_mass_sheet_with_shear" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em></p>
<p>Whether an external mass sheet is included in the
model with non-zero shear</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.is_xallarap">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_xallarap</span></span><a class="headerlink" href="#MulensModel.ModelParameters.is_xallarap" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em></p>
<p>Whether the parameters include the xallarap or not.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.source_1_parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_1_parameters</span></span><a class="headerlink" href="#MulensModel.ModelParameters.source_1_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
<p>Parameters of source 1 in multi-source model.</p>
<p><strong>Do not change returned values.</strong> To change
parameters of the source 1, simply change the parameters of double
source instance.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.source_2_parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_2_parameters</span></span><a class="headerlink" href="#MulensModel.ModelParameters.source_2_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
<p>Parameters of source 2 in multi-source model.</p>
<p><strong>Do not change returned values.</strong> To change
parameters of the source 1, simply change the parameters of double
source instance.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.uniform_caustic_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uniform_caustic_sampling</span></span><a class="headerlink" href="#MulensModel.ModelParameters.uniform_caustic_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MulensModel.uniformcausticsampling.html#MulensModel.uniformcausticsampling.UniformCausticSampling" title="MulensModel.uniformcausticsampling.UniformCausticSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniformCausticSampling</span></code></a></p>
<p>An instance of the class
<a class="reference internal" href="MulensModel.uniformcausticsampling.html#MulensModel.uniformcausticsampling.UniformCausticSampling" title="MulensModel.uniformcausticsampling.UniformCausticSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniformCausticSampling</span></code></a>
that is used to calculate standard parameters based on
the curvelinear coordinates.
The main usage is access to the <em>jacobian()</em> function.
In most cases, you do not need to access this property directly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.ModelParameters.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.ModelParameters.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Give parameters as a dict.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>dictionary: <em>dict</em></dt><dd><p>The dictionary of model parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.MulensData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">MulensData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phot_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi2_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'flux'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ephemerides_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_2450000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_2460000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">good</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A set of photometric measurements for a microlensing event.</p>
<dl>
<dt>Examples of how to define a MulensData object:</dt><dd><p>data = MulensData(file_name=SAMPLE_FILE_01)</p>
<p>data = MulensData(data_list=[[Dates], [Magnitudes], [Errors]])</p>
</dd>
</dl>
<p><strong>Parallax calculations assume that the dates supplied are
BJD_TDB. See</strong> <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>. If
you aren’t using parallax, the time system shouldn’t matter as
long as it is consistent across all MulensData and Model objects.
If you have multiple datasets, then you also need multiple instances
of MulensData class.</p>
<dl>
<dt>Keywords :</dt><dd><dl class="simple">
<dt>data_list: [<em>list</em> of <em>lists</em>, <em>numpy.ndarray</em>], optional</dt><dd><p>The list that contains three <em>lists</em> or <em>numpy.ndarrays</em>
that specify: time, magnitude or flux, and its uncertainty
(in that order). The lengths of these three objects must be
the same.</p>
</dd>
<dt>file_name: <em>str</em>, optional</dt><dd><p>The path to a file with columns: Date, Magnitude/Flux,
Err. Loaded using <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.loadtxt()</span></code>. See <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>.</p>
</dd>
</dl>
<p><strong>Either data_list or file_name is required.</strong></p>
<dl class="simple">
<dt>phot_fmt: <em>str</em></dt><dd><p>Specifies whether the photometry is provided in magnitude or flux
space. Accepts either ‘mag’ or ‘flux’. Default = ‘mag’.</p>
</dd>
<dt>chi2_fmt: <em>str</em></dt><dd><p>Specifies whether the format used for chi^2 calculation
should be done in Magnitude or Flux spaces. Accepts either
‘mag’ or ‘flux’. Default is ‘flux’ because almost always
the errors are gaussian in flux space.</p>
</dd>
<dt>ephemerides_file: <em>str</em>, optional</dt><dd><p>Specify the ephemerides of a satellite over the period when
the data were taken. You may want to extend the time range
to get nicer plots. Will be interpolated as necessary to
model the satellite parallax effect. See <a class="reference external" href="https://github.com/rpoleski/MulensModel/blob/master/documents/Horizons_manual.md">instructions</a> on
getting satellite positions.
Note that there is no check on time format (e.g., BJD TBD vs. HJD)
and it should be the same as in <em>data_list</em> or <em>file_name</em>.</p>
</dd>
<dt>add_2450000: <em>boolean</em>, optional</dt><dd><p>Adds 2450000 to the input dates. Useful if the dates
are supplied as HJD-2450000.</p>
</dd>
<dt>add_2460000: <em>boolean</em>, optional</dt><dd><p>Adds 2460000 to the input dates. Useful if the dates
are supplied as HJD-2460000.</p>
</dd>
</dl>
<p>bandpass: see <a class="reference internal" href="#MulensModel.MulensData.bandpass" title="MulensModel.MulensData.bandpass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bandpass</span></code></a></p>
<dl>
<dt>bad: <em>boolean np.ndarray</em>, optional</dt><dd><p>Flags for bad data (data to exclude from fitting and
plotting). Should be the same length as the number of data
points.</p>
</dd>
<dt>good: <em>boolean np.ndarray</em>, optional</dt><dd><p>Flags for good data, should be the same length as the
number of data points.</p>
</dd>
<dt>plot_properties: <em>dict</em>, optional</dt><dd><p>Specify properties for plotting, e.g. <code class="docutils literal notranslate"><span class="pre">color</span></code>, <code class="docutils literal notranslate"><span class="pre">marker</span></code>,
<code class="docutils literal notranslate"><span class="pre">label</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, <code class="docutils literal notranslate"><span class="pre">zorder</span></code>, <code class="docutils literal notranslate"><span class="pre">markersize</span></code>, <code class="docutils literal notranslate"><span class="pre">visible</span></code>,
and also the <code class="docutils literal notranslate"><span class="pre">show_bad</span></code> and <code class="docutils literal notranslate"><span class="pre">show_errorbars</span></code>
properties.</p>
<p>Note: pyplot functions errorbar() and scatter() are used to
plot data with errorbars and without them, respectively.
The type and size of marker are specified using different
keywords: (‘fmt’, ‘markersize’) for errorbar() and
(‘marker’, ‘size’) for scatter(). You can use either convention
in <a class="reference internal" href="#MulensModel.MulensData.plot_properties" title="MulensModel.MulensData.plot_properties"><code class="xref py py-attr docutils literal notranslate"><span class="pre">plot_properties</span></code></a> and they will be translated
to appropriate keywords. If there are similar problems with
other keywords, then they won’t be translated unless you
contact code authors.</p>
<dl class="simple">
<dt>Other special keys :</dt><dd><dl class="simple">
<dt>show_errorbars: <em>boolean</em>, optional</dt><dd><p>Whether or not to show the errorbars for this dataset.</p>
</dd>
<dt>show_bad: <em>boolean</em>, optional</dt><dd><p>Whether or not to plot data points flagged as bad.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>Kwargs passed to np.loadtxt(). Works only if <code class="docutils literal notranslate"><span class="pre">file_name</span></code> is set.</p>
</dd>
</dl>
</dd>
</dl>
<p>You can print an instance of this class, which always provides label and
information on the total number of epochs and the number of bad epochs.
If applicable, additional information is provided: bandpass,
ephemerides file, color used for plotting, and errorbar scaling.</p>
<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.plot_properties">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_properties</span></span><a class="headerlink" href="#MulensModel.MulensData.plot_properties" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em></p>
<p>Settings that specify how the photometry should be plotted.</p>
<p>The keys in this <em>dict</em> could be either special keys introduced here
(i.e., <code class="docutils literal notranslate"><span class="pre">show_bad</span></code> and <code class="docutils literal notranslate"><span class="pre">show_errorbars</span></code>) or keys accepted by
matplotlib.pyplot plotting functions. The latter could be for example
<code class="docutils literal notranslate"><span class="pre">color</span></code>, <code class="docutils literal notranslate"><span class="pre">marker</span></code>, <code class="docutils literal notranslate"><span class="pre">label</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, <code class="docutils literal notranslate"><span class="pre">zorder</span></code>,
<code class="docutils literal notranslate"><span class="pre">markersize</span></code>, or <code class="docutils literal notranslate"><span class="pre">visible</span></code>.</p>
<p>See <a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a>
for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MulensData.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phot_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_errorbars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_bad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2450000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_2460000</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensData.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the data.</p>
<p>Uses <a class="reference internal" href="#MulensModel.MulensData.plot_properties" title="MulensModel.MulensData.plot_properties"><code class="xref py py-attr docutils literal notranslate"><span class="pre">plot_properties</span></code></a> for label, color, etc.
This settings can be changed by setting <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>.</p>
<p>You can plot in either flux or magnitude space.</p>
<dl class="simple">
<dt>Keywords:</dt><dd><dl class="simple">
<dt>phot_fmt: <em>string</em> (‘mag’, ‘flux’)</dt><dd><p>Whether to plot the data in magnitudes or in flux. Default
is the same as <a class="reference internal" href="#MulensModel.MulensData.input_fmt" title="MulensModel.MulensData.input_fmt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">input_fmt</span></code></a>.</p>
</dd>
<dt>show_errorbars: <em>boolean</em></dt><dd><p>If show_errorbars is True (default), plots with
matplotlib.errorbar(). If False, plots with
matplotlib.scatter().</p>
</dd>
<dt>show_bad: <em>boolean</em></dt><dd><p>If False, bad data are suppressed (default).
If True, shows points marked as bad
(<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData.bad" title="MulensModel.mulensdata.MulensData.bad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mulensdata.MulensData.bad</span></code></a>) as ‘x’</p>
</dd>
<dt>subtract_2450000, subtract_2460000: <em>boolean</em></dt><dd><p>If True, subtracts 2450000 or 2460000 from the time
axis to get more human-scale numbers. If using it, make
sure to also set the same settings for all other
plotting calls (e.g. <code class="xref py py-func docutils literal notranslate"><span class="pre">plot_lc()</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>passed to matplotlib plotting functions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MulensData.set_limb_darkening_weights">
<span class="sig-name descname"><span class="pre">set_limb_darkening_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensData.set_limb_darkening_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a dictionary of weights that will be used to evaluate the
limb darkening coefficient. See also
<a class="reference internal" href="MulensModel.limbdarkeningcoeffs.html#MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs" title="MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbDarkeningCoeffs</span></code></a></p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>weights: <em>dict</em></dt><dd><p>A dictionary that specifies weight for each
bandpass. Keys are <em>str</em> and values are <em>float</em>, e.g.,
<code class="docutils literal notranslate"><span class="pre">{'I':</span> <span class="pre">1.5,</span> <span class="pre">'V':</span> <span class="pre">1.}</span></code> if the I-band gamma
limb-darkening coefficient is 1.5-times larger than
the V-band.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#MulensModel.MulensData.time" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>vector of dates</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.mag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mag</span></span><a class="headerlink" href="#MulensModel.MulensData.mag" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>magnitude vector</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.err_mag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">err_mag</span></span><a class="headerlink" href="#MulensModel.MulensData.err_mag" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>vector of magnitude errors</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.flux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flux</span></span><a class="headerlink" href="#MulensModel.MulensData.flux" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy.ndarray</em></p>
<p>Vector of the measured brightness in flux units.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.err_flux">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">err_flux</span></span><a class="headerlink" href="#MulensModel.MulensData.err_flux" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>Vector of uncertainties of <em>flux</em> values.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.bad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bad</span></span><a class="headerlink" href="#MulensModel.MulensData.bad" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray boolean</em></p>
<p>flags marking bad data</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.good">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">good</span></span><a class="headerlink" href="#MulensModel.MulensData.good" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray boolean</em></p>
<p>flags marking good data i.e., opposite to <a class="reference internal" href="#MulensModel.MulensData.bad" title="MulensModel.MulensData.bad"><code class="xref py py-func docutils literal notranslate"><span class="pre">bad()</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.n_epochs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_epochs</span></span><a class="headerlink" href="#MulensModel.MulensData.n_epochs" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>give total number of epochs (including bad data)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MulensData.data_and_err_in_input_fmt">
<span class="sig-name descname"><span class="pre">data_and_err_in_input_fmt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensData.data_and_err_in_input_fmt" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives photometry in input format (mag or flux).</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>data: <em>np.ndarray</em></dt><dd><p>Magnitudes or fluxes</p>
</dd>
<dt>data_err: <em>np.ndarray</em></dt><dd><p>Uncertainties of magnitudes or of fluxes</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MulensData.data_and_err_in_chi2_fmt">
<span class="sig-name descname"><span class="pre">data_and_err_in_chi2_fmt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensData.data_and_err_in_chi2_fmt" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives photometry in format used for chi2 calculation
(flux in most cases, but magnitude possible).</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>data: <em>np.ndarray</em></dt><dd><p>Magnitudes or fluxes</p>
</dd>
<dt>data_err: <em>np.ndarray</em></dt><dd><p>Uncertainties of magnitudes or of fluxes</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.bandpass">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bandpass</span></span><a class="headerlink" href="#MulensModel.MulensData.bandpass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>String</em></p>
<p>Bandpass of given dataset (primary usage is limb darkening), e.g. ‘I’
or ‘V’. Returns <em>None</em> if not set.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.satellite_skycoord">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">satellite_skycoord</span></span><a class="headerlink" href="#MulensModel.MulensData.satellite_skycoord" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Astropy.SkyCoord</em> object for satellite
positions at epochs covered by the dataset</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>skycoord: <em>astropy.coordinates.SkyCoord</em></dt><dd><p>satellite positions at epochs covered by the dataset</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.input_fmt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_fmt</span></span><a class="headerlink" href="#MulensModel.MulensData.input_fmt" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> (‘mag’ or ‘flux’)</p>
<p>Input format - same as <em>phot_fmt</em> keyword in __init__().</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.chi2_fmt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chi2_fmt</span></span><a class="headerlink" href="#MulensModel.MulensData.chi2_fmt" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> (‘mag’ or ‘flux’)</p>
<p>Photometry format used  for chi^2 calculations. Default is ‘flux’.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.ephemerides_file">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ephemerides_file</span></span><a class="headerlink" href="#MulensModel.MulensData.ephemerides_file" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em></p>
<p>File with satellite ephemeris.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MulensData.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensData.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of given instance with settings copied</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>mulens_data: <a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData" title="MulensModel.mulensdata.MulensData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensData</span></code></a></dt><dd><p>Copy of self.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MulensData.scale_errorbars">
<span class="sig-name descname"><span class="pre">scale_errorbars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensData.scale_errorbars" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale magnitude errorbars by multiplying by <em>factor</em> and
then adding <em>minimum</em> in squares.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>factor: <em>float</em></dt><dd><p>Multiplication factor. Typically used for faint events.</p>
</dd>
<dt>minimum: <em>float</em></dt><dd><p>Floor of magnitude errorbars. Typically used for bright
events.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.errorbars_scale_factors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">errorbars_scale_factors</span></span><a class="headerlink" href="#MulensModel.MulensData.errorbars_scale_factors" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> of two <em>floats</em></p>
<p>Parameters used by <a class="reference internal" href="#MulensModel.MulensData.scale_errorbars" title="MulensModel.MulensData.scale_errorbars"><code class="xref py py-func docutils literal notranslate"><span class="pre">scale_errorbars()</span></code></a>.
The first one is multiplication factor,
while the second is the minimum scatter added in squares.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensData.errorbars_scaling_equation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">errorbars_scaling_equation</span></span><a class="headerlink" href="#MulensModel.MulensData.errorbars_scaling_equation" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em></p>
<p>Equation and parameters used by <a class="reference internal" href="#MulensModel.MulensData.scale_errorbars" title="MulensModel.MulensData.scale_errorbars"><code class="xref py py-func docutils literal notranslate"><span class="pre">scale_errorbars()</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.Lens">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">Lens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_proj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Lens" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A mass or system of masses.</p>
<p>Standard parameter combinations for defining a Lens object:</p>
<dl class="simple">
<dt>Point Lens:</dt><dd><p>(<a class="reference internal" href="#MulensModel.Lens.mass" title="MulensModel.Lens.mass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mass</span></code></a>, <a class="reference internal" href="#MulensModel.Lens.distance" title="MulensModel.Lens.distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distance</span></code></a>)</p>
</dd>
</dl>
<p>2+ body lens:</p>
<blockquote>
<div><p>(<a class="reference internal" href="#MulensModel.Lens.s" title="MulensModel.Lens.s"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s</span></code></a>, <a class="reference internal" href="#MulensModel.Lens.q" title="MulensModel.Lens.q"><code class="xref py py-obj docutils literal notranslate"><span class="pre">q</span></code></a>)</p>
<p>(<a class="reference internal" href="#MulensModel.Lens.epsilon" title="MulensModel.Lens.epsilon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">epsilon</span></code></a>, <a class="reference internal" href="#MulensModel.Lens.s" title="MulensModel.Lens.s"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s</span></code></a>)</p>
<p>(<a class="reference internal" href="#MulensModel.Lens.total_mass" title="MulensModel.Lens.total_mass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">total_mass</span></code></a>, <a class="reference internal" href="#MulensModel.Lens.epsilon" title="MulensModel.Lens.epsilon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">epsilon</span></code></a>, <a class="reference internal" href="#MulensModel.Lens.distance" title="MulensModel.Lens.distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distance</span></code></a>)
- Missing s/Not Implemented?</p>
<p>(<a class="reference internal" href="#MulensModel.Lens.mass_1" title="MulensModel.Lens.mass_1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mass_1</span></code></a>, <a class="reference internal" href="#MulensModel.Lens.mass_2" title="MulensModel.Lens.mass_2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mass_2</span></code></a>, <a class="reference internal" href="#MulensModel.Lens.a_proj" title="MulensModel.Lens.a_proj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">a_proj</span></code></a>,
<a class="reference internal" href="#MulensModel.Lens.distance" title="MulensModel.Lens.distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distance</span></code></a>) - Not Implemented</p>
</div></blockquote>
<p>Note that s, q, and epsilon may be single values, lists, or numpy ndarrays.</p>
<p>If units are not specified for a given mass, it is assumed the
value given is in Solar Masses.</p>
<p>If units are not specified for distance it is assumed the value is
given in kpc.</p>
<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.epsilon">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">epsilon</span></span><a class="headerlink" href="#MulensModel.Lens.epsilon" title="Permalink to this definition">¶</a></dt>
<dd><p>[<em>float, list, numpy.ndarray</em>]</p>
<p>An array of mass fractions for each lens components:
m_i/total_mass. Stored as a <em>numpy.ndarray</em>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.q">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">q</span></span><a class="headerlink" href="#MulensModel.Lens.q" title="Permalink to this definition">¶</a></dt>
<dd><p>[<em>float, list, numpy.ndarray</em>]</p>
<p>mass ratio for companions relative to the primary</p>
<p>Array of mass ratios defined relative to the primary
(m_i/m_1). Size is number of components -1. Set as a list,
np.ndarray, or single value.</p>
<p>Note: if <a class="reference internal" href="#MulensModel.Lens.total_mass" title="MulensModel.Lens.total_mass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">total_mass</span></code></a> is defined before q, it is
assumed this is the mass of the primary. If you want this to
actually be the total mass, define it after defining q.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.s">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#MulensModel.Lens.s" title="Permalink to this definition">¶</a></dt>
<dd><p>[<em>float, list, numpy.ndarray</em>]</p>
<p>Separation between the components of the lens as a fraction of
the Einstein ring. A np.ndarray or single value.</p>
<p>Definitions for more than 2 lens bodies TBD</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.total_mass">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_mass</span></span><a class="headerlink" href="#MulensModel.Lens.total_mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The total mass of the lens (sum of all components). An
astropy.Quantity with mass units. If set as a <em>float</em>, units
are assumed to be solMass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.mass">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mass</span></span><a class="headerlink" href="#MulensModel.Lens.mass" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The mass of a point lens –&gt; total mass. An astropy.Quantity
with mass units. May be set as a float (in which case solMass
is assumed).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.mass_1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mass_1</span></span><a class="headerlink" href="#MulensModel.Lens.mass_1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The mass of the primary. Defined as total_mass *
epsilon[0]. An <em>astropy.Quantity</em> with mass units. If set as a
<em>float</em>, units are assumed to be solMass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.mass_2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mass_2</span></span><a class="headerlink" href="#MulensModel.Lens.mass_2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The mass of the secondary. Defined as total_mass *
epsilon[1]. An <em>astropy.Quantity</em> with mass units. If set as a
<em>float</em>, units are assumed to be solMass.</p>
<p>Note that if total_mass is defined before mass_2, and there is
no epsilon corresponding to mass_2, mass_2 is added to the
total_mass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.mass_3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mass_3</span></span><a class="headerlink" href="#MulensModel.Lens.mass_3" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The mass of the tertiary. Defined as total_mass * epsilon[2].
An <em>astropy.Quantity</em> with mass units. If set as a <em>float</em>,
units are assumed to be solMass.</p>
<p>Note that if total_mass is defined before mass_3, and there is
no epsilon corresponding to mass_3, mass_3 is added to the total_mass.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.n_masses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_masses</span></span><a class="headerlink" href="#MulensModel.Lens.n_masses" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em>, read-only</p>
<p>number of masses in the system.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.distance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#MulensModel.Lens.distance" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The distance to the lens.</p>
<p>May be set as a <em>float</em>. If no unit is given, the value is
assumed to be kpc.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.pi_L">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pi_L</span></span><a class="headerlink" href="#MulensModel.Lens.pi_L" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The parallax to the lens in milliarcseconds. May be set as a
<em>float</em>, in which case units are assumed to be
milliarcseconds.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.a_proj">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">a_proj</span></span><a class="headerlink" href="#MulensModel.Lens.a_proj" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>Projected separation between the components of the lens in
AU. An <em>astropy.Quantity</em> with distance units. If set as <em>float</em>
(without units), AU is assumed.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Lens.caustics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">caustics</span></span><a class="headerlink" href="#MulensModel.Lens.caustics" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">Caustics</span></code> object, read-only</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Lens.plot_caustics">
<span class="sig-name descname"><span class="pre">plot_caustics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Lens.plot_caustics" title="Permalink to this definition">¶</a></dt>
<dd><p>A function to plot the x,y coordinates (scaled to the
Einstein ring) of the caustics. <a class="reference external" href="https://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.scatter">Pyplot scatter</a> is used for
plotting. See <code class="xref py py-func docutils literal notranslate"><span class="pre">MulensModel.caustics.Caustics.plot()</span></code>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>n_points: <em>int</em></dt><dd><p>Number of points be plotted.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>Keyword arguments passed to <cite>Pyplot scatter</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.Source">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">Source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angular_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limb_darkening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Source" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Physical properties of a source (background) star.</p>
<dl>
<dt>Attributes :</dt><dd><p>limb_darkening:
<a class="reference internal" href="MulensModel.limbdarkeningcoeffs.html#MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs" title="MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbDarkeningCoeffs</span></code></a></p>
<blockquote>
<div><p>Limb darkening coefficients of the source.</p>
</div></blockquote>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Source.distance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#MulensModel.Source.distance" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The distance to the source. May be set as a <em>float</em>.
The distance should either be given in pc, or if no unit is
given, the value is assumed to be kpc (<em>u.kpc</em>).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Source.pi_S">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pi_S</span></span><a class="headerlink" href="#MulensModel.Source.pi_S" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The parallax to the source in millarcseconds. May be set as a
<em>float</em>. If no units are specified, assumes milliarcseconds (<em>u.mas</em>).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Source.angular_radius">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">angular_radius</span></span><a class="headerlink" href="#MulensModel.Source.angular_radius" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>Angular radius of the source. May be set as a <em>float</em>. If
units are not specified, assumed to be microarcseconds (<em>u.mas</em>).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.MulensSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">MulensSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_rel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A microlensing system consisting of a lens and a source.</p>
<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.lens">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lens</span></span><a class="headerlink" href="#MulensModel.MulensSystem.lens" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="MulensModel.mulensobjects.lens.html#MulensModel.mulensobjects.lens.Lens" title="MulensModel.mulensobjects.lens.Lens"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lens</span></code></a> object.
Physical properties of the lens. Note: lens mass must be in
solMasses.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.source">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source</span></span><a class="headerlink" href="#MulensModel.MulensSystem.source" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MulensModel.mulensobjects.source.html#MulensModel.mulensobjects.source.Source" title="MulensModel.mulensobjects.source.Source"><code class="xref py py-class docutils literal notranslate"><span class="pre">Source</span></code></a> object.
Physical properties of the source.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.mu_rel">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mu_rel</span></span><a class="headerlink" href="#MulensModel.MulensSystem.mu_rel" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>Relative proper motion between the source and lens
stars. If set as a <em>float</em>, units are assumed to be mas/yr.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.t_E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_E</span></span><a class="headerlink" href="#MulensModel.MulensSystem.t_E" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em></p>
<p>The Einstein crossing time (in days). If set as a <em>float</em>,
assumes units are in days.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.pi_rel">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pi_rel</span></span><a class="headerlink" href="#MulensModel.MulensSystem.pi_rel" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em>, read-only</p>
<p>The source-lens relative parallax in milliarcseconds.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.pi_E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pi_E</span></span><a class="headerlink" href="#MulensModel.MulensSystem.pi_E" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em>, read-only</p>
<p>The Einstein ring radius. It’s equal to pi_rel / theta_E.
Dimensionless.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.theta_E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_E</span></span><a class="headerlink" href="#MulensModel.MulensSystem.theta_E" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em>, read-only</p>
<p>The angular Einstein Radius in milliarcseconds.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.r_E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_E</span></span><a class="headerlink" href="#MulensModel.MulensSystem.r_E" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em>, read-only</p>
<p>The physical size of the Einstein Radius in the Lens plane (in AU).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.r_E_tilde">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_E_tilde</span></span><a class="headerlink" href="#MulensModel.MulensSystem.r_E_tilde" title="Permalink to this definition">¶</a></dt>
<dd><p><em>astropy.Quantity</em>, read-only</p>
<p>The physical size of the Einstein Radius projected onto the
Observer plane (in AU).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.plot_magnification">
<span class="sig-name descname"><span class="pre">plot_magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensSystem.plot_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the magnification curve for the lens. u_0 must always be
specified. If the lens has more than one body, alpha must also
be specified.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>u_0: <em>float</em></dt><dd><p>Impact parameter between the source and the lens (as a
fraction of the Einstein ring)</p>
</dd>
<dt>alpha: <em>astropy.Quantity</em>, <em>float</em></dt><dd><p>If <em>float</em> then degrees are assumed as a unit.
See <a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters.alpha" title="MulensModel.modelparameters.ModelParameters.alpha"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MulensModel.modelparameters.ModelParameters.alpha</span></code></a></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>See <a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model.plot_magnification" title="MulensModel.model.Model.plot_magnification"><code class="xref py py-func docutils literal notranslate"><span class="pre">MulensModel.model.Model.plot_magnification()</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.MulensSystem.plot_caustics">
<span class="sig-name descname"><span class="pre">plot_caustics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.MulensSystem.plot_caustics" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the caustics structure using <a class="reference external" href="https://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.scatter">Pyplot scatter</a>. See
<code class="xref py py-func docutils literal notranslate"><span class="pre">MulensModel.caustics.Caustics.plot()</span></code></p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>n_points: <em>int</em></dt><dd><p>Number of points be plotted.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>:</dt><dd><p>Keyword arguments passed to <cite>Pyplot scatter</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.PointSourcePointLensMagnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">PointSourcePointLensMagnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.PointSourcePointLensMagnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.pointlens._PointLensMagnification</span></code></p>
<p>Equations for calculating point-source–point-lens magnification and
its derivatives.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.PointSourcePointLensMagnification.get_magnification">
<span class="sig-name descname"><span class="pre">get_magnification</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.PointSourcePointLensMagnification.get_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the magnification</p>
<p>Parameters : None</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>magnification: <em>float</em> or <em>np.ndarray</em></dt><dd><p>The magnification for each point
specified by <cite>u</cite> in <a class="reference internal" href="MulensModel.trajectory.html#module-MulensModel.trajectory" title="MulensModel.trajectory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">trajectory</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.PointSourcePointLensMagnification.get_d_A_d_u">
<span class="sig-name descname"><span class="pre">get_d_A_d_u</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.PointSourcePointLensMagnification.get_d_A_d_u" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate dA/du for PSPL point-source–point-lens model.</p>
<p>No parameters.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>dA_du: <em>np.ndarray</em></dt><dd><p>Derivative dA/du evaluated at each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceUniformGould94Magnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">FiniteSourceUniformGould94Magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FiniteSourceUniformGould94Magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.pointlens._PointLensMagnification</span></code></p>
<p>Equations for calculating finite-source–point-lens magnification and
its derivatives following the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1994ApJ...421L..71G/abstract">Gould 1994 ApJ, 421L, 71</a>
prescription assuming a <em>uniform</em> (and circular) source.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
<dt>direct: <em>bool</em></dt><dd><p>Use direct calculation (slow) instead of interpolation. Default is
False.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceUniformGould94Magnification.get_d_A_d_u">
<span class="sig-name descname"><span class="pre">get_d_A_d_u</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FiniteSourceUniformGould94Magnification.get_d_A_d_u" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate dA/du for USPL uniform-source–point-lens model.</p>
<p>No parameters.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>dA_du: <em>np.ndarray</em></dt><dd><p>Derivative dA/du evaluated at each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceUniformGould94Magnification.get_magnification">
<span class="sig-name descname"><span class="pre">get_magnification</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FiniteSourceUniformGould94Magnification.get_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate magnification for point lens and finite source (for
a <em>uniform</em> source).  The approximation was proposed by:
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1994ApJ...421L..71G/abstract">Gould A. 1994 ApJ 421L, 71 “Proper motions of MACHOs”</a>
and later the integral calculation was simplified by:
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2004ApJ...603..139Y/abstract">Yoo J. et al. 2004 ApJ 603, 139 “OGLE-2003-BLG-262: Finite-Source
Effects from a Point-Mass Lens”</a>
This approach assumes rho is small (rho &lt; 0.1). For larger sources
use <code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteSourceUniformLee09Magnification</span></code>.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>magnification: <em>float</em>, <em>np.array</em></dt><dd><p>The finite-source source magnification for each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceUniformGould94Magnification.get_d_A_d_params">
<span class="sig-name descname"><span class="pre">get_d_A_d_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FiniteSourceUniformGould94Magnification.get_d_A_d_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the gradient of the magnification with respect to the
FSPL parameters for each epoch.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>parameters: <em>list</em></dt><dd><p>List of the parameters to take derivatives with respect to.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>dA_dparams: <em>dict</em></dt><dd><p>Keys are parameter names from <em>parameters</em> argument above.
Values are the partial derivatives for that parameter
evaluated at each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceUniformGould94Magnification.get_d_A_d_rho">
<span class="sig-name descname"><span class="pre">get_d_A_d_rho</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FiniteSourceUniformGould94Magnification.get_d_A_d_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the magnification with respect to rho
for each epoch.</p>
<p>No parameters.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>dA_drho: <em>np.ndarray</em></dt><dd><p>Derivative dA/drho evaluated at each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceUniformGould94Magnification.z_">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">z_</span></span><a class="headerlink" href="#MulensModel.FiniteSourceUniformGould94Magnification.z_" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>Magnitude of lens-source separation scaled to rho for each epoch
(i.e., z = u/rho).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceUniformGould94Magnification.b0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">b0</span></span><a class="headerlink" href="#MulensModel.FiniteSourceUniformGould94Magnification.b0" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>The value of the B_0(z) function for each epoch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceUniformGould94Magnification.db0">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db0</span></span><a class="headerlink" href="#MulensModel.FiniteSourceUniformGould94Magnification.db0" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>Derivative of the B_0(z) function for each epoch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceLDYoo04Magnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">FiniteSourceLDYoo04Magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FiniteSourceLDYoo04Magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="MulensModel.pointlens.html#MulensModel.pointlens.FiniteSourceUniformGould94Magnification" title="MulensModel.pointlens.FiniteSourceUniformGould94Magnification"><code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.pointlens.FiniteSourceUniformGould94Magnification</span></code></a></p>
<p>Equations for calculating finite-source–point-lens magnification and
its derivatives following the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1994ApJ...421L..71G/abstract">Gould 1994 ApJ, 421L, 71</a>
prescription assuming a <em>limb-darkened</em> (and circular) source.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
<dt>direct: <em>bool</em></dt><dd><p>Use direct calculation (slow) instead of interpolation. Default is
False.</p>
</dd>
<dt>gamma: <em>float</em></dt><dd><p>The limb-darkening coefficient. See also
<a class="reference internal" href="MulensModel.limbdarkeningcoeffs.html#MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs" title="MulensModel.limbdarkeningcoeffs.LimbDarkeningCoeffs"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbDarkeningCoeffs</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceLDYoo04Magnification.get_magnification">
<span class="sig-name descname"><span class="pre">get_magnification</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FiniteSourceLDYoo04Magnification.get_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate magnification for point lens and finite source (for
a <em>uniform</em> source).  The approximation was proposed by:
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1994ApJ...421L..71G/abstract">Gould A. 1994 ApJ 421L, 71 “Proper motions of MACHOs”</a>
and later the integral calculation was simplified by:
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2004ApJ...603..139Y/abstract">Yoo J. et al. 2004 ApJ 603, 139 “OGLE-2003-BLG-262: Finite-Source
Effects from a Point-Mass Lens”</a>
This approach assumes rho is small (rho &lt; 0.1). For larger sources
use <code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteSourceLDLee09Magnification</span></code>.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>magnification: <em>float</em>, <em>np.array</em></dt><dd><p>The finite-source source magnification for each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceLDYoo04Magnification.get_d_A_d_u">
<span class="sig-name descname"><span class="pre">get_d_A_d_u</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FiniteSourceLDYoo04Magnification.get_d_A_d_u" title="Permalink to this definition">¶</a></dt>
<dd><p>Finite-source modification to derivatives of other parameters.
= Factor due to rho for multiplying derivatives due to
non-rho parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceLDYoo04Magnification.get_d_A_d_rho">
<span class="sig-name descname"><span class="pre">get_d_A_d_rho</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.FiniteSourceLDYoo04Magnification.get_d_A_d_rho" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the derivative of the magnification with respect to rho
for each epoch.</p>
<p>No parameters.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>dA_drho: <em>np.ndarray</em></dt><dd><p>Derivative dA/drho evaluated at each epoch.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceLDYoo04Magnification.b1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">b1</span></span><a class="headerlink" href="#MulensModel.FiniteSourceLDYoo04Magnification.b1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>Value of the B_1(z) function for each epoch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceLDYoo04Magnification.db1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db1</span></span><a class="headerlink" href="#MulensModel.FiniteSourceLDYoo04Magnification.db1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>Derivative of the B_1(z) function for each epoch.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.FiniteSourceLDYoo04Magnification.gamma">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gamma</span></span><a class="headerlink" href="#MulensModel.FiniteSourceLDYoo04Magnification.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Limb-darkening gamma coefficient.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.PointSourcePointLensWithShearMagnification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">PointSourcePointLensWithShearMagnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.PointSourcePointLensWithShearMagnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MulensModel.pointlens._PointLensMagnification</span></code></p>
<p>Lens of point mass plus shear and convergence, i.e., Chang-Refsdal lens.</p>
<p>This lens was first considered by
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1979Natur.282..561C/abstract">Chang and Refsdal (1979; Nature, 282, 561)</a>.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>trajectory: <a class="reference internal" href="MulensModel.trajectory.html#MulensModel.trajectory.Trajectory" title="MulensModel.trajectory.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a></dt><dd><p>Including trajectory.parameters =
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.PointSourcePointLensWithShearMagnification.get_magnification">
<span class="sig-name descname"><span class="pre">get_magnification</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.PointSourcePointLensWithShearMagnification.get_magnification" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate point source magnification for the lens composed of
a single mass plus a mass sheet.</p>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>pspl_magnification: <em>np.ndarray</em></dt><dd><p>The point-source–point-lens magnification for each point
specified by <cite>trajectory</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.B0B1Utils">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">B0B1Utils</span></span><a class="headerlink" href="#MulensModel.B0B1Utils" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Data and methods used for interpolation for finite-source point-lens
magnification calculations.</p>
<p>There are no parameters of <cite>__init__()</cite>. In general, this class is not
directly used by a user.</p>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.B0B1Utils.interpolate_B0">
<span class="sig-name descname"><span class="pre">interpolate_B0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.B0B1Utils.interpolate_B0" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate B_0(z) function.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>z: <em>np.ndarray</em></dt><dd><p>Values of u/rho.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>B0: <em>np.ndarray</em></dt><dd><p>Values of B_0.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.B0B1Utils.interpolate_B0minusB1">
<span class="sig-name descname"><span class="pre">interpolate_B0minusB1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.B0B1Utils.interpolate_B0minusB1" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate B_0(z)-B_1(z) function.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>z: <em>np.ndarray</em></dt><dd><p>Values of u/rho.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>B0_minus_B1: <em>np.ndarray</em></dt><dd><p>Values of B_0(z)-B_1(z).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.B0B1Utils.interpolate_B1">
<span class="sig-name descname"><span class="pre">interpolate_B1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.B0B1Utils.interpolate_B1" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate B_1(z) function.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>z: <em>np.ndarray</em></dt><dd><p>Values of u/rho.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>B1: <em>np.ndarray</em></dt><dd><p>Values of B_1(z).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.B0B1Utils.interpolate_B0prime">
<span class="sig-name descname"><span class="pre">interpolate_B0prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.B0B1Utils.interpolate_B0prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate derivative of B_0(z), i.e., d B_0(z)/d z.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>z: <em>np.ndarray</em></dt><dd><p>Values of u/rho.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>dB0_dz: <em>np.ndarray</em></dt><dd><p>Values of d B_0(z)/d z.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.B0B1Utils.interpolate_B1prime">
<span class="sig-name descname"><span class="pre">interpolate_B1prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.B0B1Utils.interpolate_B1prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate derivative of B_1(z), i.e., d B_1(z)/d z.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>z: <em>np.ndarray</em></dt><dd><p>Values of u/rho.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>dB1_dz: <em>np.ndarray</em></dt><dd><p>Values of d B_1(z)/d z.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.B0B1Utils.get_interpolation_mask">
<span class="sig-name descname"><span class="pre">get_interpolation_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.B0B1Utils.get_interpolation_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mask of z values for which interpolation of B_0(z), B_1(z) etc.
is allowed</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>z: <em>np.ndarray</em></dt><dd><p>Values of u/rho.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>mask: <em>np.ndarray</em></dt><dd><p>Mask indicating for which z values interpolation is allowed.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.B0B1Utils.z_max_interpolation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">z_max_interpolation</span></span><a class="headerlink" href="#MulensModel.B0B1Utils.z_max_interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum value of z for which interpolation is allowed.</p>
<p><em>float</em></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.EllipUtils">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">EllipUtils</span></span><a class="headerlink" href="#MulensModel.EllipUtils" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Data and methods used for interpolation for finite-source point-lens
magnification calculations.</p>
<p>There are no parameters of <cite>__init__()</cite>. In general, this class is not
directly used by a user.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.SatelliteSkyCoord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">SatelliteSkyCoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ephemerides_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.SatelliteSkyCoord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>An object that gives the <em>Astropy.SkyCoord</em> of satellite for a given
epoch based on an ephemerides file.</p>
<dl class="simple">
<dt>Keywords :</dt><dd><dl class="simple">
<dt>ephemerides_file: <em>str</em></dt><dd><p>path to file with satellite ephemerides from JPL horizons,
for examples see <em>data/ephemeris_files/Spitzer_ephemeris_01.dat</em>
or <em>data/ephemeris_files/K2_ephemeris_01.dat</em></p>
</dd>
<dt>satellite: <em>str</em>, optional</dt><dd><p>Just the name of the satellite.</p>
</dd>
</dl>
</dd>
<dt>Attributes :</dt><dd><dl class="simple">
<dt>satellite: <em>str</em></dt><dd><p>name of the satellite</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.SatelliteSkyCoord.get_satellite_coords">
<span class="sig-name descname"><span class="pre">get_satellite_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.SatelliteSkyCoord.get_satellite_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the coordinates of the satellite for given times
using cubic interpolation. The epheris provided is extrapolated
up to 3 minutes beyond the range provided.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>times: <em>np.ndarray</em> or <em>list of floats</em></dt><dd><p>Epochs for which satellite coordinates will be calculated.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>satellite_skycoord: <em>Astropy.coordinates.SkyCoord</em></dt><dd><p><em>SkyCoord</em> for satellite at epochs <em>times</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.Trajectory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">Trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">satellite_skycoord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">earth_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>The (dimensionless) X, Y trajectory of the source in the source
plane. This class includes internal functions that calculate how
microlensing parallax affects the trajectory.</p>
<p>For binary lens, the origin of the coordinate system is at the
center of mass with higher mass (assuming q &lt; 1) at negative X and
Y=0.</p>
<p>This class follows the conventions defined in Appendix A of
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2011ApJ...738...87S/abstract">Skowron et al. (2011)</a>
except the definition of <em>alpha</em>, which is shifted by 180 deg.</p>
<dl>
<dt>Arguments :</dt><dd><dl class="simple">
<dt>times: [<em>float</em>, <em>list</em>, <em>np.ndarray</em>]</dt><dd><p>the times at which to generate the source trajectory,
e.g. a vector. Either <em>times</em> OR (<em>x</em> AND <em>y</em>) are required.</p>
</dd>
</dl>
<p>parameters: instance of
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a>, required</p>
<blockquote>
<div><p>a ModelParameters object specifying the microlensing parameters</p>
</div></blockquote>
<dl class="simple">
<dt>x, y: [<em>float</em>, <em>list</em>, <em>np.ndarray</em>]</dt><dd><p>Dimensionless X, Y coordinates of trajectory. Either <em>times</em> OR
(<em>x</em> AND <em>y</em>) are required.</p>
</dd>
<dt>parallax: <em>boolean dictionary</em>, optional</dt><dd><p>specifies what parallax effects should be used. Default is
<em>False</em> for each of <em>‘earth_orbital’</em>, <em>‘satellite’</em>, and
<em>‘topocentric’</em>. (differs from
<a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model" title="MulensModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> which defaults to
<em>True</em>)</p>
</dd>
</dl>
<p>coords: <em>str</em>, or
<a class="reference internal" href="MulensModel.coordinates.html#MulensModel.coordinates.Coordinates" title="MulensModel.coordinates.Coordinates"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coordinates</span></code></a>,
<em>Astropy.coordinates.SkyCoord</em>, optional</p>
<blockquote>
<div><p>sky coordinates of the event; required for parallax calculations</p>
</div></blockquote>
<dl class="simple">
<dt>satellite_skycoord: <em>Astropy.coordinates.SkyCoord</em>, optional</dt><dd><p>sky coordinates of the satellite specified by the
ephemerides file. See
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData.satellite_skycoord" title="MulensModel.mulensdata.MulensData.satellite_skycoord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">satellite_skycoord</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt>Attributes :</dt><dd><dl class="simple">
<dt>parameters: <a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></dt><dd><p>input <a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a></p>
</dd>
<dt>satellite_skycoord: <em>Astropy.coordinates.SkyCoord</em></dt><dd><p>input
<a class="reference internal" href="MulensModel.mulensdata.html#MulensModel.mulensdata.MulensData.satellite_skycoord" title="MulensModel.mulensdata.MulensData.satellite_skycoord"><code class="xref py py-attr docutils literal notranslate"><span class="pre">satellite_skycoord</span></code></a></p>
</dd>
<dt>parallax: <em>dict</em></dt><dd><p>specifies which types of microlensing parallax will be taken
into account; boolean dict with keys: <code class="docutils literal notranslate"><span class="pre">earth_orbital</span></code>,
<code class="docutils literal notranslate"><span class="pre">satellite</span></code>, and <code class="docutils literal notranslate"><span class="pre">topocentric</span></code> (default values are <em>False</em>)</p>
</dd>
<dt>coords: <a class="reference internal" href="MulensModel.coordinates.html#MulensModel.coordinates.Coordinates" title="MulensModel.coordinates.Coordinates"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coordinates</span></code></a></dt><dd><p>event coordinates</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Trajectory.x">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#MulensModel.Trajectory.x" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>Dimensionless X coordinates of trajectory.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Trajectory.y">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#MulensModel.Trajectory.y" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>Dimensionless Y coordinates of trajectory.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Trajectory.times">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">times</span></span><a class="headerlink" href="#MulensModel.Trajectory.times" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em> or <em>None</em></p>
<p>Epochs for which trajectory is calculated.
<em>None</em> if the class was initialized without epochs provided.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Trajectory.parallax_delta_N_E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parallax_delta_N_E</span></span><a class="headerlink" href="#MulensModel.Trajectory.parallax_delta_N_E" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em></p>
<p>Net North (key=’N’) and East (key=’E’) components of the parallax
offset calculated for each time stamp (so sum of the offsets from all
parallax types).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.Trajectory.d_perp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">d_perp</span></span><a class="headerlink" href="#MulensModel.Trajectory.d_perp" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em></p>
<p>Projection of the Earth-Satellite
separation vector (in AU) on the sky.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">UniformCausticSampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.UniformCausticSampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Uniform sampling of a binary lens caustic.
Note that calculations take some time for given (s, q).
Keep that in mind, when optimizing your fitting routine.</p>
<dl class="simple">
<dt>Arguments :</dt><dd><dl class="simple">
<dt>s: <em>float</em></dt><dd><p>Separation of the two lens components relative to
the Einstein ring size.</p>
</dd>
<dt>q: <em>float</em></dt><dd><p>Mass ratio of the two lens components.</p>
</dd>
<dt>n_points: <em>int</em></dt><dd><p>Number of points used for internal integration.
Default value should work fine.</p>
</dd>
</dl>
</dd>
</dl>
<p>Instead of standard parameters (<em>t_0</em>, <em>u_0</em>, <em>t_E</em>, <em>alpha</em>), here
we use four other parameters: two epochs of caustic crossing
(<em>t_caustic_in</em>, <em>t_caustic_out</em>) and two curvelinear coordinates of
caustic crossing (<em>x_caustic_in</em>, <em>x_caustic_out</em>).</p>
<p>The curvelinear coordinate, <em>x_caustic</em>,
is defined so that going from 0 to 1 draws all caustics
for given separation and mass ratio. We use 0-1 range, which is
a different convention than
in the papers cited below (we also use different symbols for
epochs of caustic crossing and curvelinear coordinates).
For a wide topology (i.e., 2 caustics), there
is a value between 0 and 1 (called <code class="docutils literal notranslate"><span class="pre">x_caustic_sep</span></code>) which separates
the caustics and a trajectory
exists only if <em>x_caustic_in</em> and <em>x_caustic_out</em> correspond to
the same caustic, i.e., both are smaller than <code class="docutils literal notranslate"><span class="pre">x_caustic_sep</span></code> or
both are larger than <code class="docutils literal notranslate"><span class="pre">x_caustic_sep</span></code>. For a close topology
(i.e., 3 caustics), there are two such separating values.</p>
<p>For description of the curvelinear coordinates, see:</p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2008A%26A...491..587C/abstract">Cassan A. 2008 A&amp;A 491, 587 “An alternative parameterisation for
binary-lens caustic-crossing events”</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2010A%26A...515A..52C/abstract">Cassan A. et al. 2010 A&amp;A 515, 52
“Bayesian analysis of caustic-crossing microlensing events”</a></p>
<p>In order to visualize the curvelinear coordinates,
you can run a code like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">sampling</span> <span class="o">=</span> <span class="n">UniformCausticSampling</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">sampling</span><span class="o">.</span><span class="n">caustic_point</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">color</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">imag</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>This will show an intermediate topology. Change <em>s=1.1</em> to <em>s=2.</em>
to plot a wide topology, or to <em>s=0.7</em> to plot a close topology.</p>
<p>To be specific, the central caustics are plotted counter-clockwise
and <em>x_caustic=0.</em> corresponds to right-hand point where the caustic
crosses the X-axis. For a wide topology, the planetary caustic is
plotted in a similar way. For a close topology, the lower planetary
caustic is plotted counter-clockwise and the upper planetary caustic
is symmetric, thus plotted clockwise. For planetary caustics in
a close topology, the zero-point of <em>x_caustic</em> values is defined
in a very complicated way, however it is a smooth function of
<em>s</em> and <em>q</em>.</p>
<p>For more advanced fitting of binary lens events see:</p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2009MNRAS.395..787K/abstract">Kains N. et al. 2009 MNRAS 395, 787
“A systematic fitting scheme for caustic-crossing microlensing events”</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2012MNRAS.426.2228K/abstract">Kains N. et al. 2012 MNRAS 426, 2228 “A Bayesian algorithm for model
selection applied to caustic-crossing binary-lens microlensing events”</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.get_standard_parameters">
<span class="sig-name descname"><span class="pre">get_standard_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_caustic_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_caustic_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_caustic_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_caustic_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.UniformCausticSampling.get_standard_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get standard binary lens parameters (i.e., <code class="docutils literal notranslate"><span class="pre">t_0</span></code>, <code class="docutils literal notranslate"><span class="pre">u_0</span></code>, <code class="docutils literal notranslate"><span class="pre">t_E</span></code>,
<code class="docutils literal notranslate"><span class="pre">alpha</span></code>; see
<a class="reference internal" href="MulensModel.modelparameters.html#MulensModel.modelparameters.ModelParameters" title="MulensModel.modelparameters.ModelParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelParameters</span></code></a>)
based on provided curvelinear parameters.</p>
<p>Note that this function quite frequently raises <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>
exception. This is because not all
(<code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">q</span></code>, <code class="docutils literal notranslate"><span class="pre">x_caustic_in</span></code>, and <code class="docutils literal notranslate"><span class="pre">x_caustic_out</span></code>)
correspond to real trajectories. The returned values are in
conventions used by <a class="reference internal" href="MulensModel.model.html#MulensModel.model.Model" title="MulensModel.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>.</p>
<dl class="simple">
<dt>Keywords :</dt><dd><dl class="simple">
<dt>x_caustic_in: <em>float</em></dt><dd><p>Curvelinear coordinate of caustic entrance.
Must be in (0, 1) range.</p>
</dd>
<dt>x_caustic_out: <em>float</em></dt><dd><p>Curvelinear coordinate of caustic exit.
Must be in (0, 1) range.</p>
</dd>
<dt>t_caustic_in: <em>float</em></dt><dd><p>Epoch of caustic entrance.</p>
</dd>
<dt>t_caustic_out: <em>float</em></dt><dd><p>Epoch of caustic exit.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>parameters: <em>dict</em></dt><dd><p>Dictionary with standard binary parameters, i.e, keys are
<code class="docutils literal notranslate"><span class="pre">t_0</span></code>, <code class="docutils literal notranslate"><span class="pre">u_0</span></code>, <code class="docutils literal notranslate"><span class="pre">t_E</span></code>, and <code class="docutils literal notranslate"><span class="pre">alpha</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.get_x_in_x_out">
<span class="sig-name descname"><span class="pre">get_x_in_x_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.UniformCausticSampling.get_x_in_x_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate where given trajectory crosses the caustic.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>u_0: <em>float</em></dt><dd><p>The parameter u_0 of source trajectory, i.e., impact parameter.</p>
</dd>
<dt>alpha: <em>float</em></dt><dd><p>Angle defining the source trajectory.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>x_caustic_points: <em>list</em> of <em>float</em></dt><dd><p>Caustic coordinates of points where given trajectory crosses
the caustic. The length is 0, 2, 4, or 6.
Note that if there are 4 or 6 points,
then only some pairs will produce real trajectories.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.get_uniform_sampling">
<span class="sig-name descname"><span class="pre">get_uniform_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_min_for_caustic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caustic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.UniformCausticSampling.get_uniform_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample uniformly (x_caustic_in, x_caustic_out) space according to
Jacobian and requirement that x_caustic_in corresponds to caustic
entrance, and x_caustic_out corresponds to caustic exit. The Jacobian
is defined by Eq. 23 of:</p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2010A%26A...515A..52C/abstract">Cassan A. et al. 2010 A&amp;A 515, 52
“Bayesian analysis of caustic-crossing microlensing events”</a></p>
<p>and the above requirement is defined under Eq. 27 of that paper.</p>
<p>Relative number of points per caustic is not yet specified.
Points do not repeat. This function is useful for sampling starting
distribution for model fitting. For example sampling see
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2010A%26A...515A..52C/abstract">Cassan et al. (2010)</a>
bottom panel of Fig. 1.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>n_points: <em>int</em></dt><dd><p>number of points to be returned</p>
</dd>
<dt>n_min_for_caustic: <em>int</em></dt><dd><p>minimum number of points in each caustic</p>
</dd>
<dt>caustic: <em>int</em> or <em>None</em></dt><dd><p>Select which caustic will be sampled. <em>None</em> means all
caustics. Can be <em>1</em>, <em>2</em>, or <em>3</em> but has to be
&lt;= <a class="reference internal" href="#MulensModel.UniformCausticSampling.n_caustics" title="MulensModel.UniformCausticSampling.n_caustics"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_caustics</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>x_caustic_in: <em>np.ndarray</em></dt><dd><p>Randomly drawn entrance points.</p>
</dd>
<dt>x_caustic_out: <em>np.ndarray</em></dt><dd><p>Corresponding randomly drawn exit points.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.jacobian">
<span class="sig-name descname"><span class="pre">jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_caustic_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_caustic_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.UniformCausticSampling.jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates Eq. 23 from Cassan et al. (2010) with condition under Eq. 27.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>x_caustic_in: <em>float</em></dt><dd><p>Point of caustic entrance.</p>
</dd>
<dt>x_caustic_out: <em>float</em></dt><dd><p>Point of caustic exit.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>jacobian: <em>float</em></dt><dd><p>Value of Jacobian. Returns <em>0.</em> if trajectory does not exist.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.check_valid_trajectory">
<span class="sig-name descname"><span class="pre">check_valid_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_caustic_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_caustic_out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.UniformCausticSampling.check_valid_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if given (x_caustic_in, x_caustic_out) define an existing
trajectory. An obvious case, when they don’t is when both caustic
points are on the same fold, but other cases exists.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>x_caustic_in: <em>float</em></dt><dd><p>Coordinate of putative caustic entrance.</p>
</dd>
<dt>x_caustic_out: <em>float</em></dt><dd><p>Coordinate of putative caustic exit.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>check: <em>bool</em></dt><dd><p><em>True</em> if input defines a trajectory, <em>False</em> if it does not.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.caustic_point">
<span class="sig-name descname"><span class="pre">caustic_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_caustic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.UniformCausticSampling.caustic_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate caustic position corresponding to given x_caustic.</p>
<dl class="simple">
<dt>Keywords :</dt><dd><dl class="simple">
<dt>x_caustic: <em>float</em></dt><dd><p>Curvelinear coordinate of the point considered.
Has to be in 0-1 range.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>point: <em>numpy.complex128</em></dt><dd><p>Caustic point in complex coordinates.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.which_caustic">
<span class="sig-name descname"><span class="pre">which_caustic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_caustic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.UniformCausticSampling.which_caustic" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates on which caustic given point is.</p>
<dl>
<dt>Keywords :</dt><dd><dl class="simple">
<dt>x_caustic: <em>float</em></dt><dd><p>Curvelinear coordinate to be checked</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl>
<dt>i_caustic: <em>int</em></dt><dd><p>Number indicating the caustic:</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code> - central caustic,</p>
<p><code class="docutils literal notranslate"><span class="pre">2</span></code> - planetary caustic; for close configuration it is
the lower of the two planetary caustics,</p>
<p><code class="docutils literal notranslate"><span class="pre">3</span></code> - upper planetary caustic.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.n_caustics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_caustics</span></span><a class="headerlink" href="#MulensModel.UniformCausticSampling.n_caustics" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>Number of caustics: <em>1</em> for resonant topology, <em>2</em> for wide topology,
or <em>3</em> for close topology.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.s">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#MulensModel.UniformCausticSampling.s" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>separation of the two lens components relative to Einstein ring size</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MulensModel.UniformCausticSampling.q">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">q</span></span><a class="headerlink" href="#MulensModel.UniformCausticSampling.q" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>Mass ratio.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MulensModel.Utils">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MulensModel.</span></span><span class="sig-name descname"><span class="pre">Utils</span></span><a class="headerlink" href="#MulensModel.Utils" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A number of small functions used in different places</p>
<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.get_flux_from_mag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_flux_from_mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeropoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.get_flux_from_mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform magnitudes into fluxes.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>mag: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Values to be transformed.</p>
</dd>
<dt>zeropoint: <em>float</em>, optional</dt><dd><p>Zeropoint of magnitude scale.
Defaults to 22. - double check if you want to change this.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>flux: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Calculated fluxes. Type is the same as <em>mag</em> parameter.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.get_flux_and_err_from_mag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_flux_and_err_from_mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeropoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.get_flux_and_err_from_mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform magnitudes and their uncertainties into flux space.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>mag: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Magnitude values to be transformed.</p>
</dd>
<dt>err_mag: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Uncertainties of magnitudes to be transformed.</p>
</dd>
<dt>zeropoint: <em>float</em></dt><dd><p>Zeropoint of magnitude scale.
Defaults to 22. - double check if you want to change this.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>flux: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Calculated fluxes. Type is the same as <em>mag</em> parameter.</p>
</dd>
<dt>err_flux: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Calculated flux uncertainties. Type is <em>float</em> if both <em>mag</em>
and <em>err_mag</em> are <em>floats</em> and <em>np.ndarray</em> otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.get_mag_from_flux">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_mag_from_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeropoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.get_mag_from_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform fluxes into magnitudes.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>flux: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Values to be transformed.</p>
</dd>
<dt>zeropoint: <em>float</em></dt><dd><p>Zeropoint of magnitude scale.
Defaults to 22. - double check if you want to change this.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>mag: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Calculated fluxes. Type is the same as <em>flux</em> parameter.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.get_mag_and_err_from_flux">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_mag_and_err_from_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeropoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.get_mag_and_err_from_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform fluxes and their uncertainties into magnitude space.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>flux: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Flux values to be transformed.</p>
</dd>
<dt>err_flux: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Uncertainties of fluxes to be transformed.</p>
</dd>
<dt>zeropoint: <em>float</em></dt><dd><p>Zeropoint of magnitude scale.
Defaults to 22. - double check if you want to change this.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>mag: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Calculated fluxes. Type is the same as <em>mag</em> parameter.</p>
</dd>
<dt>err_mag: <em>np.ndarray</em> or <em>float</em></dt><dd><p>Calculated magnitude uncertainties. Type is <em>float</em> if both
<em>flux</em> and <em>err_flux</em> are <em>floats</em> and <em>np.ndarray</em> otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.gamma_to_u">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gamma_to_u</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.gamma_to_u" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform gamma limb darkening coefficient to u in convention
introduced by <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002ApJ...572..521A/abstract">An et al. 2008 (ApJ 681, 1593)</a>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>gamma: <em>float</em></dt><dd><p>Limb darkening coefficient in gamma convention.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>u: <em>float</em></dt><dd><p>Limb darkening coefficient in u convention.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.u_to_gamma">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">u_to_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.u_to_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform u limb darkening coefficient to gamma in convention
introduced by <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002ApJ...572..521A/abstract">An et al. 2008 (ApJ 681, 1593)</a>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>u: <em>float</em></dt><dd><p>Limb darkening coefficient in u convention.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>gamma: <em>float</em></dt><dd><p>Limb darkening coefficient in gamma convention.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.get_n_caustics">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_n_caustics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.get_n_caustics" title="Permalink to this definition">¶</a></dt>
<dd><p>Find number of caustics for binary lens.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>s: <em>float</em></dt><dd><p>Separation of binary lens relative to theta_E.</p>
</dd>
<dt>q: <em>float</em></dt><dd><p>Mass ratio (&lt;1).</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>n_caustics: <em>int</em></dt><dd><p>Number of caustics: 1, 2, or 3.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.velocity_of_Earth">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">velocity_of_Earth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_BJD</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.velocity_of_Earth" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate 3D velocity of Earth for given epoch.</p>
<p>If you need velocity projected on the plane of the sky, then use
<a class="reference internal" href="MulensModel.coordinates.html#MulensModel.coordinates.Coordinates.v_Earth_projected" title="MulensModel.coordinates.Coordinates.v_Earth_projected"><code class="xref py py-func docutils literal notranslate"><span class="pre">v_Earth_projected()</span></code></a></p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>full_BJD: <em>float</em></dt><dd><p>Barycentric Julian Data. Full means it should begin
with 245… or 246…</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>velocity: <em>np.ndarray</em> (<em>float</em>, size of (3,))</dt><dd><p>3D velocity in km/s. The frame follows <em>Astropy</em> conventions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.complex_fsum">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">complex_fsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arguments</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.complex_fsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Accurate floating points sum of complex numbers in iterable.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><p>arguments: <em>iterable</em> (e.g., <em>list</em> or <em>np.ndarray</em>)</p>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>sum: <em>complex</em></dt><dd><p>Sum of <em>arguments</em>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.vector_product_normalized">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vector_product_normalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.vector_product_normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Get vector that is perpendicular to the 2 input ones and is normalized.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>vector_1: <em>np.ndarray</em> (3,)</dt><dd><p>First vector.</p>
</dd>
<dt>vector_2: <em>np.ndarray</em> (3,)</dt><dd><p>Second vector.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>vector_product_norm: <em>np.ndarray</em> (3,)</dt><dd><p>Normalized vector product of the inputs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.dot">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cartesian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Dot product of 2 vectors represented by
<em>astropy.CartesianRepresentation</em> and <em>np.ndarray</em>.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>cartesian: <em>astropy.CartesianRepresentation</em></dt><dd><p>First vector.</p>
</dd>
<dt>vector: <em>np.ndarray</em></dt><dd><p>Second vector (length 3).</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>dot_product: <em>astropy.Quantity</em></dt><dd><p>Dot product of inputs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.date_change">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">date_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.date_change" title="Permalink to this definition">¶</a></dt>
<dd><p>Change format of month in date, e.g.
<em>‘2015-Oct-30 12:00’</em> -&gt; <em>‘2015-10-30 12:00’</em></p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>text: <em>str</em></dt><dd><p>Date to be changed.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out_text: <em>str</em></dt><dd><p>Changed text.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MulensModel.Utils.astropy_version_check">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">astropy_version_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minimum</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#MulensModel.Utils.astropy_version_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <em>astropy</em> package is installed at given or later version.</p>
<dl class="simple">
<dt>Parameters :</dt><dd><dl class="simple">
<dt>minimum: <em>str</em></dt><dd><p>Minimum version, e.g., <em>‘3.1.2’</em>.</p>
</dd>
</dl>
</dd>
<dt>Returns :</dt><dd><dl class="simple">
<dt>out: <em>bool</em></dt><dd><p>Is the installed version later?</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">MulensModel</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_fit_pspl.html">Fitting tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_fit_pi_E.html">Parallax fitting tutorial</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Radek Poleski, Jennifer Yee.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/MulensModel.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>